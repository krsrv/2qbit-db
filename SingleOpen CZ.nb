(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    231129,       6214]
NotebookOptionsPosition[    224255,       6090]
NotebookOutlinePosition[    224650,       6106]
CellTagsIndexPosition[    224607,       6103]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Bare CZ gate sequence fidelities wrt initial states", "Section",
 CellChangeTimes->{{3.958828836910049*^9, 
  3.9588288556909027`*^9}},ExpressionUUID->"55b79880-2956-440d-9d56-\
5451b79343e1"],

Cell[TextData[{
 "Problem: Given an initial state ",
 Cell[BoxData[
  TemplateBox[{"\[Psi]"},
   "Ket"]],ExpressionUUID->"83655876-518f-4ee1-88cb-c88246a518a1"],
 ", and the gate sequence ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    SuperscriptBox["CZ", 
     RowBox[{"4", "k"}]], "}"}], TraditionalForm]],ExpressionUUID->
  "106f19d9-36a4-49cf-ba32-487ba5a64c84"],
 ", find the fidelity of the final state under open system effects. Consider \
only ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", 
    RowBox[{"1", ",", "2"}]], TraditionalForm]],ExpressionUUID->
  "c64e06a2-2e36-4e18-9ed7-5e5f86f2ce1a"],
 " processes for the open system decoherence mechanisms.\nApproach: We will \
solve the problem perturbatively. The CZ gate duration is assumed to be much \
smaller than the timescale associated with the decay of the system. \
Therefore, we will treat the gate and open system effects as separate \
channels. More concretely, if \[CapitalPhi] represents the exact open system \
evolution under the CZ gate, we approximate \[CapitalPhi] \[TildeEqual] \
\[CapitalEpsilon] \[SmallCircle]\[CapitalUpsilon] where \[CapitalUpsilon] is \
the unitary map corresponding to the 4 (now instantaneous) CZ gates and \
\[CapitalEpsilon] is the pure decoherence map under ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", 
    RowBox[{"1", ",", "2"}]], TraditionalForm]],ExpressionUUID->
  "387ef4e8-4b7f-4f98-85f5-2df3306e2b84"],
 " effects."
}], "Text",
 CellChangeTimes->{{3.9588288602393*^9, 3.958829090749655*^9}, {
  3.958829124019265*^9, 3.958829300430109*^9}, {3.958845382747856*^9, 
  3.958845385751358*^9}},ExpressionUUID->"a4dc8ee4-e9ce-4559-a0ca-\
accc5e421d9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Channel \[CapitalUpsilon] - closed system gate", "Section",
 CellChangeTimes->{{3.958830633197515*^9, 
  3.958830643436008*^9}},ExpressionUUID->"d1ce3c16-d565-40e4-a6bd-\
b7739b782d8c"],

Cell[CellGroupData[{

Cell["Gate unitary", "Subsection",
 CellChangeTimes->{{3.958840668085511*^9, 
  3.958840670059402*^9}},ExpressionUUID->"68dd9af3-7337-4023-b15f-\
872a370711ab"],

Cell["\<\
The CZ gate ideally has a \[Pi]/4 amplitude, but it can have overrotation \
terms.\
\>", "Text",
 CellChangeTimes->{{3.958830662140567*^9, 3.958830664550098*^9}, {
  3.9588307192667713`*^9, 3.9588307211812553`*^9}, {3.958840092476668*^9, 
  3.9588401246840763`*^9}, {3.958840660049726*^9, 
  3.9588406609262133`*^9}},ExpressionUUID->"89fc5a1f-584d-4905-8cf8-\
c1ebbd1f0bea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"A_", "\[CircleTimes]", "B_"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"A", ",", "B"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";", 
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{
     RowBox[{
      FractionBox["\[Pi]", "4"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Z", "\[CircleTimes]", "Z"}], "-", 
        RowBox[{"Z", "\[CircleTimes]", "Id"}], "-", 
        RowBox[{"Id", "\[CircleTimes]", "Z"}]}], ")"}]}], "+", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Eta]", " ", 
        RowBox[{"Z", "\[CircleTimes]", "Z"}]}], "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"Z", "\[CircleTimes]", "Id"}]}], "+", 
       RowBox[{"\[Kappa]", " ", 
        RowBox[{"Id", "\[CircleTimes]", "Z"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Note", " ", "that", " ", "we", " ", "removed", " ", "the", " ", 
     "explicit", " ", "time", " ", "dependence"}], ",", " ", 
    RowBox[{
    "and", " ", "we", " ", "integrate", " ", "over", " ", "a", " ", "unit", 
     " ", "time", " ", 
     RowBox[{"s", ".", "t", ".", " ", 
      RowBox[{"Integral", "[", "H", "]"}]}], " ", "has", " ", "an", " ", 
     "amplitude", " ", "of", " ", 
     RowBox[{"\[Pi]", "/", "4."}], " ", "The", " ", "error", " ", 
     "amplitudes", " ", "should", " ", "be", " ", 
     RowBox[{
      RowBox[{"<<", " ", "\[Pi]"}], "/", "4"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", "H"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "/", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"\[Pi]", "/", "4"}]}]]}], "//", "MatrixForm"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", ".", "U", ".", "U", ".", "U"}], "//", "MatrixForm"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.9588401300491734`*^9, 3.95884017853583*^9}, {
  3.958840258894088*^9, 3.958840286216227*^9}, {3.958840332026746*^9, 
  3.958840370501889*^9}, {3.958840412108972*^9, 3.958840413447856*^9}, {
  3.958845283505836*^9, 3.958845284882296*^9}, {3.958845513457498*^9, 
  3.958845597409704*^9}, {3.959170007883226*^9, 3.9591700484652243`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"dd1b35d0-0676-4d43-b0a9-b89cb932ebaf"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "+", "\[Eta]", "+", "\[Kappa]"}], ")"}]}]], 
      "0", "0", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "-", "\[Eta]", "-", "\[Kappa]"}], ")"}]}]], 
      "0", "0"},
     {"0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "+", "\[Eta]", "-", "\[Kappa]"}], ")"}]}]], 
      "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "-", "\[Eta]", "+", "\[Kappa]"}], ")"}]}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9588403531728067`*^9, 3.9588403710525713`*^9}, 
   3.958840413740774*^9, 3.958845285814189*^9, 3.9590984148412533`*^9, {
   3.959170014800523*^9, 3.9591700492579327`*^9}, 3.959451323197023*^9},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"c12f396e-58e0-45b6-bc92-\
59fb0303da22"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "+", "\[Eta]", "+", "\[Kappa]"}], ")"}]}]]}], 
      "0", "0", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Pi]", "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "\[Epsilon]"}], "+", "\[Eta]", "+", "\[Kappa]"}], 
            ")"}]}]}], ")"}]}]], "0", "0"},
     {"0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Pi]", "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "+", "\[Eta]", "-", "\[Kappa]"}], ")"}]}]}],
          ")"}]}]], "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "-", "\[Eta]", "+", "\[Kappa]"}], ")"}]}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.9588403531728067`*^9, 3.9588403710525713`*^9}, 
   3.958840413740774*^9, 3.958845285814189*^9, 3.9590984148412533`*^9, {
   3.959170014800523*^9, 3.9591700492579327`*^9}, 3.9594513233206244`*^9},
 CellLabel->
  "Out[13]//MatrixForm=",ExpressionUUID->"2093ed95-6187-4418-9118-\
7591e146e942"]
}, Open  ]],

Cell["The unitary is of the form", "Text",
 CellChangeTimes->{{3.958840421490883*^9, 
  3.958840426666936*^9}},ExpressionUUID->"1ff696ee-143d-4faf-836f-\
9a5bffe84731"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "+", "\[Eta]", "+", "\[Kappa]"}], ")"}]}]], 
       "0", "0", "0"},
      {"0", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "-", "\[Eta]", "-", "\[Kappa]"}], ")"}]}]], 
       "0", "0"},
      {"0", "0", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "+", "\[Eta]", "-", "\[Kappa]"}], ")"}]}]], 
       "0"},
      {"0", "0", "0", 
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", "\[Eta]", "+", "\[Kappa]"}], 
           ")"}]}]]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "->", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], 
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]], 
       "0", "0", "0"},
      {"0", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], "0", "0"},
      {"0", "0", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]], "0"},
      {"0", "0", "0", 
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]], "Input",
 CellChangeTimes->{{3.9588404379254713`*^9, 3.958840503942519*^9}, {
  3.958840554489045*^9, 3.958840555496149*^9}, {3.959170102898682*^9, 
  3.959170120762944*^9}},ExpressionUUID->"f56cc8ce-4fd0-44c9-bedd-\
6641034c50c0"],

Cell["where \[Alpha] = (-\[Epsilon]+\[Eta]+\[Kappa]), \[Beta] = (\[Epsilon]+\
\[Eta]-\[Kappa]), \[Gamma] =  (\[Epsilon]-\[Eta]+\[Kappa]).", "Text",
 CellChangeTimes->{{3.958840509196562*^9, 3.958840539891938*^9}, {
  3.958840657599979*^9, 3.9588406784803467`*^9}, {3.959170123077064*^9, 
  3.95917012568334*^9}},ExpressionUUID->"cee6c32b-8282-460e-a709-\
6b084f8d2d16"]
}, Closed]],

Cell[CellGroupData[{

Cell["Gate channel", "Subsection",
 CellChangeTimes->{{3.958840689426248*^9, 
  3.958840690673361*^9}},ExpressionUUID->"814929b1-5e1b-445b-969a-\
594e8fda502e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]], 
        "0", "0", "0"},
       {"0", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}]], "0", "0"},
       {"0", "0", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]], "0"},
       {"0", "0", "0", 
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]]}]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConjugateTranspose", "[", "U", "]"}], ".", "U"}], "//", 
   "Simplify"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.958840694987249*^9, 3.958840721352909*^9}, {
   3.958840827062005*^9, 3.958840829770624*^9}, 3.959170134596458*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"ac5953f5-b527-4555-b7f0-7641c0647b5d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]", "-", 
          RowBox[{"Conjugate", "[", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], "]"}]}], 
         ")"}]}]], "0", "0", "0"},
     {"0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", 
          RowBox[{"Conjugate", "[", "\[Alpha]", "]"}]}], ")"}]}]], "0", "0"},
     {"0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"Conjugate", "[", "\[Beta]", "]"}]}], ")"}]}]], "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", 
          RowBox[{"Conjugate", "[", "\[Gamma]", "]"}]}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.958840721609633*^9, 3.958845302708634*^9, 
  3.959098856878069*^9, 3.959098903166623*^9, 3.959170136490868*^9, 
  3.959451327573048*^9},
 CellLabel->
  "Out[15]//MatrixForm=",ExpressionUUID->"41fab7d2-8fe0-49f9-867d-\
6bb2eac0a4a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalUpsilon]", "[", "\[Rho]_", "]"}], ":=", 
   RowBox[{"U", ".", "\[Rho]", ".", 
    RowBox[{"ConjugateTranspose", "[", "U", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Refine", "[", 
   RowBox[{
    RowBox[{"\[CapitalUpsilon]", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"i", ",", "j"}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Beta]", "\[Element]", "Reals"}], ",", 
       RowBox[{"\[Gamma]", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.958840740778852*^9, 3.958840785965281*^9}, {
  3.958840832485427*^9, 3.958840863010013*^9}, {3.9588417498430777`*^9, 
  3.958841752430599*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"bb02253f-c2a6-49ee-bb5a-5cb560a9dbca"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]}]], 
       " ", 
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Beta]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]}]], 
       " ", 
       SubscriptBox["a", 
        RowBox[{"1", ",", "3"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Gamma]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], 
            ")"}]}]}]]}], " ", 
       SubscriptBox["a", 
        RowBox[{"1", ",", "4"}]]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]}]], 
       " ", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]]}], 
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "-", 
         RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]}]], " ", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "3"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[Alpha]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]}]]}], " ", 
       SubscriptBox["a", 
        RowBox[{"2", ",", "4"}]]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], ")"}]}]}]], 
       " ", 
       SubscriptBox["a", 
        RowBox[{"3", ",", "1"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]"}], "+", 
         RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}]}]], " ", 
       SubscriptBox["a", 
        RowBox[{"3", ",", "2"}]]}], 
      SubscriptBox["a", 
       RowBox[{"3", ",", "3"}]], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[Beta]"}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]}]]}], " ", 
       SubscriptBox["a", 
        RowBox[{"3", ",", "4"}]]}]},
     {
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "+", "\[Beta]", "+", "\[Gamma]"}], 
            ")"}]}]}]]}], " ", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "1"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Alpha]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]}]]}], " ", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "2"}]]}], 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Beta]"}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Gamma]"}]}]]}], " ", 
       SubscriptBox["a", 
        RowBox[{"4", ",", "3"}]]}], 
      SubscriptBox["a", 
       RowBox[{"4", ",", "4"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.958840766621132*^9, 3.958840786378894*^9}, 
   3.958840863719404*^9, 3.959098858248288*^9, 3.959098906971702*^9, 
   3.9591701501812696`*^9, 3.959451329364017*^9},
 CellLabel->
  "Out[17]//MatrixForm=",ExpressionUUID->"59d76d93-b3ea-4dd2-9a09-\
7a32bedbb8eb"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Channel \[CapitalEpsilon] - pure decoherence", "Section",
 CellChangeTimes->{{3.958828825670566*^9, 3.958828830625617*^9}, {
  3.95882931174004*^9, 3.9588293216156597`*^9}, {3.9588293820456753`*^9, 
  3.9588293828615627`*^9}},ExpressionUUID->"d26d523d-fb9f-4dd3-b2f4-\
6a0437a9200e"],

Cell[CellGroupData[{

Cell[TextData[{
 "Verify: \[CapitalEpsilon]  = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalEpsilon]", "1"], "\[SmallCircle]", 
    SubscriptBox["\[CapitalEpsilon]", "2"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "917d6992-9fcc-402c-bf33-93ce2aced2fb"]
}], "Subsection",
 CellChangeTimes->{{3.958829412335429*^9, 
  3.9588294514354963`*^9}},ExpressionUUID->"aa338469-8ac3-4ba3-9901-\
032f341c6954"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalEpsilon]", "i"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d81c9f53-963d-4ccc-8a87-946fe4add07a"],
 " is the pure decoherence channel acting only on qubit `i`. First compute \
the exact evolution given by the Lindblad master equation on the 2 qubits, \
with all the jump operators. Then compute the difference with the solution \
given by composing the 2 independent error channels ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalEpsilon]", "1"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "040385e8-a403-449e-b260-e42ae20a598b"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalEpsilon]", "2"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ee10b91f-0b96-4dca-bd48-2d32d3481111"],
 "."
}], "Text",
 CellChangeTimes->{{3.95882946402422*^9, 
  3.958829611165196*^9}},ExpressionUUID->"04e7b6ea-7189-413b-81c3-\
989f8e0c16df"],

Cell[CellGroupData[{

Cell[TextData[{
 "Exact ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ff291b35-f8d6-4e7a-8524-124c1ea610f6"]
}], "Subsubsection",
 CellChangeTimes->{{3.958829620244272*^9, 
  3.9588296249196444`*^9}},ExpressionUUID->"658b1950-7ca9-4a47-ae19-\
03b4f6c8cc19"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A_", "\[CircleTimes]", "B_"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"A", ",", "B"}], "]"}]}], ";"}]], "Input",ExpressionUUID->\
"bb85a3e5-f55b-4b0c-bd59-36d22f81a9da"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"PauliMatrix", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Sigma]", "-"], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "1", "]"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Sigma]", "+"], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"PauliMatrix", "[", "1", "]"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"PauliMatrix", "[", "2", "]"}]}]}], ")"}], "/", "2"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Id", "=", 
   RowBox[{"IdentityMatrix", "[", "2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptL]", "[", 
    RowBox[{"\[Rho]_", ",", "L_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"L", ".", "\[Rho]", ".", 
     RowBox[{"ConjugateTranspose", "[", "L", "]"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "L", "]"}], ".", "L", ".", 
        "\[Rho]"}], "+", 
       RowBox[{"\[Rho]", ".", 
        RowBox[{"ConjugateTranspose", "[", "L", "]"}], ".", "L"}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"i", ",", "j"}]], "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    SubscriptBox["T", 
     RowBox[{"i", ",", "j"}]], " ", "represents", " ", "timescale", " ", 
    "for", " ", "qubit", " ", "`j`"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"\[ScriptL]", "[", 
      RowBox[{"\[Rho]", ",", 
       RowBox[{
        SubscriptBox["\[Sigma]", "-"], "\[CircleTimes]", "Id"}]}], "]"}], 
     SubscriptBox["T", 
      RowBox[{"1", ",", "1"}]]], "+", 
    FractionBox[
     RowBox[{"\[ScriptL]", "[", 
      RowBox[{"\[Rho]", ",", 
       RowBox[{"Id", "\[CircleTimes]", 
        SubscriptBox["\[Sigma]", "-"]}]}], "]"}], 
     SubscriptBox["T", 
      RowBox[{"1", ",", "2"}]]], "+", 
    FractionBox[
     RowBox[{"\[ScriptL]", "[", 
      RowBox[{"\[Rho]", ",", 
       RowBox[{"Z", "\[CircleTimes]", "Id"}]}], "]"}], 
     SubscriptBox["T", 
      RowBox[{"\[Phi]", ",", "1"}]]], "+", 
    FractionBox[
     RowBox[{"\[ScriptL]", "[", 
      RowBox[{"\[Rho]", ",", 
       RowBox[{"Id", "\[CircleTimes]", "Z"}]}], "]"}], 
     SubscriptBox["T", 
      RowBox[{"\[Phi]", ",", "2"}]]]}], "//", "MatrixForm"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.958818866404656*^9, 3.9588189050979557`*^9}, {
  3.9588189460280952`*^9, 3.9588193604841967`*^9}, {3.9588194326015*^9, 
  3.958819437887498*^9}, {3.958819469963861*^9, 3.9588195235649443`*^9}, {
  3.9588199672653418`*^9, 3.958819967322071*^9}, {3.958829370125064*^9, 
  3.9588293727721167`*^9}},
 FontSize->14,ExpressionUUID->"640e58fa-8b57-4d66-a78a-f5c70bb2ace2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"2", ",", "2"}]], "[", "t", "]"}], 
        SubscriptBox["T", 
         RowBox[{"1", ",", "2"}]]], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"3", ",", "3"}]], "[", "t", "]"}], 
        SubscriptBox["T", 
         RowBox[{"1", ",", "1"}]]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"1", ",", "2"}]], "[", "t", "]"}], 
         RowBox[{"2", " ", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]}]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], 
        SubscriptBox["T", 
         RowBox[{"\[Phi]", ",", "2"}]]], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"3", ",", "4"}]], "[", "t", "]"}], 
        SubscriptBox["T", 
         RowBox[{"1", ",", "1"}]]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"1", ",", "3"}]], "[", "t", "]"}], 
         RowBox[{"2", " ", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "1"}]]}]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"1", ",", "3"}]], "[", "t", "]"}]}], 
        SubscriptBox["T", 
         RowBox[{"\[Phi]", ",", "1"}]]], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"2", ",", "4"}]], "[", "t", "]"}], 
        SubscriptBox["T", 
         RowBox[{"1", ",", "2"}]]]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["1", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "4"}]], "[", "t", "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"2", ",", "1"}]], "[", "t", "]"}], 
         RowBox[{"2", " ", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]}]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], 
        SubscriptBox["T", 
         RowBox[{"\[Phi]", ",", "2"}]]], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"4", ",", "3"}]], "[", "t", "]"}], 
        SubscriptBox["T", 
         RowBox[{"1", ",", "1"}]]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"2", ",", "2"}]], "[", "t", "]"}], 
         SubscriptBox["T", 
          RowBox[{"1", ",", "2"}]]]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"4", ",", "4"}]], "[", "t", "]"}], 
        SubscriptBox["T", 
         RowBox[{"1", ",", "1"}]]]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["1", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"2", ",", "3"}]], "[", "t", "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["2", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"2", ",", "4"}]], "[", "t", "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"3", ",", "1"}]], "[", "t", "]"}], 
         RowBox[{"2", " ", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "1"}]]}]]}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], 
        SubscriptBox["T", 
         RowBox[{"\[Phi]", ",", "1"}]]], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"4", ",", "2"}]], "[", "t", "]"}], 
        SubscriptBox["T", 
         RowBox[{"1", ",", "2"}]]]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["1", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"3", ",", "3"}]], "[", "t", "]"}], 
         SubscriptBox["T", 
          RowBox[{"1", ",", "1"}]]]}], "+", 
       FractionBox[
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"4", ",", "4"}]], "[", "t", "]"}], 
        SubscriptBox["T", 
         RowBox[{"1", ",", "2"}]]]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["2", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["1", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"3", ",", "4"}]], "[", "t", "]"}]}]},
     {
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["1", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"4", ",", "1"}]], "[", "t", "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["2", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"4", ",", "2"}]], "[", "t", "]"}]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["2", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["1", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox["4", 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"4", ",", "3"}]], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["1", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]]}], ")"}], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"4", ",", "4"}]], "[", "t", "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.958818976995838*^9, 3.958818991024955*^9}, {
   3.958819350434124*^9, 3.958819360838086*^9}, 3.958819439267313*^9, 
   3.9588194839004087`*^9, 3.958819523875804*^9, 3.9588199684457693`*^9, 
   3.9588239993101377`*^9},
 FontSize->14,
 CellLabel->
  "Out[137]//MatrixForm=",ExpressionUUID->"084e423e-4f2c-4591-a999-\
da0961c513c6"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "\[Rho]v", ",", "DiffEq", ",", "intialState", ",", "solution", ",", 
    "exactSolution"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]v", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{"\[Rho]", ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiffEq", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Rho]v", ",", "t"}], "]"}], "==", 
    RowBox[{"Flatten", "[", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"\[Rho]", ",", 
           RowBox[{
            SubscriptBox["\[Sigma]", "-"], "\[CircleTimes]", "Id"}]}], "]"}], 
         
         SubscriptBox["T", 
          RowBox[{"1", ",", "1"}]]], "+", 
        FractionBox[
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"\[Rho]", ",", 
           RowBox[{"Id", "\[CircleTimes]", 
            SubscriptBox["\[Sigma]", "-"]}]}], "]"}], 
         SubscriptBox["T", 
          RowBox[{"1", ",", "2"}]]], "+", 
        FractionBox[
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"\[Rho]", ",", 
           RowBox[{"Z", "\[CircleTimes]", "Id"}]}], "]"}], 
         SubscriptBox["T", 
          RowBox[{"\[Phi]", ",", "1"}]]], "+", 
        FractionBox[
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"\[Rho]", ",", 
           RowBox[{"Id", "\[CircleTimes]", "Z"}]}], "]"}], 
         SubscriptBox["T", 
          RowBox[{"\[Phi]", ",", "2"}]]]}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intialState", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"i", ",", "j"}]], "[", "0", "]"}], "==", 
         SubscriptBox["c", 
          RowBox[{"i", ",", "j"}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exactSolution", "=", 
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"DiffEq", ",", "intialState"}], "}"}], "]"}], ",", "\[Rho]v", 
     ",", "t"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958819848440634*^9, 3.95881985704029*^9}, {
  3.95881989926915*^9, 3.9588199150510187`*^9}, {3.9588199548089743`*^9, 
  3.9588200217791233`*^9}, {3.958820051845191*^9, 3.958820060347481*^9}, {
  3.958820228042801*^9, 3.95882024385918*^9}, {3.958820370393224*^9, 
  3.958820458542781*^9}, {3.958820491518718*^9, 3.958820577988565*^9}, {
  3.958820610689846*^9, 3.958820661587419*^9}, {3.9588207437868*^9, 
  3.9588207964567738`*^9}, {3.958823961063319*^9, 3.9588239688092823`*^9}, {
  3.958824040194858*^9, 3.958824052735943*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"cc56200a-8169-4f81-9973-fd212534c3bb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "/.", 
    RowBox[{"exactSolution", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9588202036567707`*^9, 3.9588202833423853`*^9}, {
  3.9588203200671787`*^9, 3.958820320875832*^9}, {3.958823970542119*^9, 
  3.958823977921534*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"bff4feaa-98e5-4810-b51b-3b9630297302"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"1", ",", "1"}]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]], "+", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "2"}]]]}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            FractionBox["t", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox["t", 
               SubscriptBox["T", 
                RowBox[{"1", ",", "2"}]]]]}], ")"}], " ", 
           SubscriptBox["c", 
            RowBox[{"2", ",", "2"}]]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox["t", 
               SubscriptBox["T", 
                RowBox[{"1", ",", "1"}]]]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["c", 
               RowBox[{"4", ",", "4"}]]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox["t", 
                SubscriptBox["T", 
                 RowBox[{"1", ",", "2"}]]]], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["c", 
                 RowBox[{"3", ",", "3"}]], "+", 
                SubscriptBox["c", 
                 RowBox[{"4", ",", "4"}]]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["2", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "+", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"3", ",", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"3", ",", "4"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["2", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "+", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"2", ",", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"2", ",", "4"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]}], "-", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"1", ",", "4"}]]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["2", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "+", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"4", ",", "3"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"4", ",", "3"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "t"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"4", ",", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"2", ",", "2"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"4", ",", "4"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]}], "-", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"2", ",", "3"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           RowBox[{"2", " ", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]}]]}], "-", 
         FractionBox["t", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox[
          RowBox[{"2", " ", "t"}], 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"2", ",", "4"}]]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["2", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "+", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"4", ",", "2"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"3", ",", "1"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"4", ",", "2"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]}], "-", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"3", ",", "2"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "t"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"4", ",", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"3", ",", "3"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"4", ",", "4"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["t", 
          RowBox[{"2", " ", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "2"}]]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", "t"}], 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"3", ",", "4"}]]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]}], "-", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"4", ",", "1"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           RowBox[{"2", " ", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]}]]}], "-", 
         FractionBox["t", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox[
          RowBox[{"2", " ", "t"}], 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"4", ",", "2"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["t", 
          RowBox[{"2", " ", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "2"}]]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", "t"}], 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"4", ",", "3"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["t", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"4", ",", "4"}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.958820214652361*^9, 3.958820251442854*^9}, 
   3.958820284188415*^9, 3.958820321320537*^9, 3.958820630402232*^9, 
   3.9588207997546587`*^9, {3.958823971309963*^9, 3.95882397904498*^9}, 
   3.95882407062368*^9},
 CellLabel->
  "Out[156]//MatrixForm=",ExpressionUUID->"5906f908-6837-4b41-86dc-\
575ab7f727ab"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[CapitalEpsilon]", "1"], "\[SmallCircle]", 
   SubscriptBox["\[CapitalEpsilon]", "2"]}], TraditionalForm]],
 FormatType->
  TraditionalForm,ExpressionUUID->"5e71669c-8da0-4240-9996-9c9f6ffddbe9"]], \
"Subsubsection",
 CellChangeTimes->{
  3.958829649280243*^9},ExpressionUUID->"08e39ea8-6d2c-44f0-b3b2-\
8b528a41afab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"\[Rho]v", ",", "DiffEq", ",", "intialState", ",", "solution"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]v", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{"\[Rho]", ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiffEq", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Rho]v", ",", "t"}], "]"}], "==", 
    RowBox[{"Flatten", "[", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"\[Rho]", ",", 
           RowBox[{
            SubscriptBox["\[Sigma]", "-"], "\[CircleTimes]", "Id"}]}], "]"}], 
         
         SubscriptBox["T", 
          RowBox[{"1", ",", "1"}]]], "+", 
        FractionBox[
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"\[Rho]", ",", 
           RowBox[{"Z", "\[CircleTimes]", "Id"}]}], "]"}], 
         SubscriptBox["T", 
          RowBox[{"\[Phi]", ",", "1"}]]]}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intialState", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"i", ",", "j"}]], "[", "0", "]"}], "==", 
         SubscriptBox["c", 
          RowBox[{"i", ",", "j"}]]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"DiffEq", ",", "intialState"}], "}"}], "]"}], ",", "\[Rho]v", 
     ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intialState", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"ArrayReshape", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"i", ",", "j"}]], "[", "0", "]"}], "==", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Rho]", "/.", 
            RowBox[{"solution", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"16", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DiffEq", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"\[Rho]v", ",", "t"}], "]"}], "==", 
    RowBox[{"Flatten", "[", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"\[Rho]", ",", 
           RowBox[{"Id", "\[CircleTimes]", 
            SubscriptBox["\[Sigma]", "-"]}]}], "]"}], 
         SubscriptBox["T", 
          RowBox[{"1", ",", "2"}]]], "+", 
        FractionBox[
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"\[Rho]", ",", 
           RowBox[{"Id", "\[CircleTimes]", "Z"}]}], "]"}], 
         SubscriptBox["T", 
          RowBox[{"\[Phi]", ",", "2"}]]]}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"DiffEq", ",", "intialState"}], "}"}], "]"}], ",", "\[Rho]v", 
     ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]", "/.", 
    RowBox[{"solution", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.958823610600778*^9, 3.958823721727282*^9}, {
  3.958824064757802*^9, 3.958824081288375*^9}, {3.958824114151349*^9, 
  3.958824114341917*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"a014baa0-e0b3-4d78-93d9-f2060f36ccff"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"1", ",", "1"}]], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "t"}], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]], "+", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "2"}]]]}], ")"}]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            FractionBox["t", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox["t", 
               SubscriptBox["T", 
                RowBox[{"1", ",", "2"}]]]]}], ")"}], " ", 
           SubscriptBox["c", 
            RowBox[{"2", ",", "2"}]]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox["t", 
               SubscriptBox["T", 
                RowBox[{"1", ",", "1"}]]]]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["c", 
               RowBox[{"4", ",", "4"}]]}], "+", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               FractionBox["t", 
                SubscriptBox["T", 
                 RowBox[{"1", ",", "2"}]]]], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["c", 
                 RowBox[{"3", ",", "3"}]], "+", 
                SubscriptBox["c", 
                 RowBox[{"4", ",", "4"}]]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["2", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "+", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"3", ",", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"3", ",", "4"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["2", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "+", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"2", ",", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"2", ",", "4"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]}], "-", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"1", ",", "4"}]]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["2", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "+", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"4", ",", "3"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"4", ",", "3"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "t"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"4", ",", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"2", ",", "2"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"4", ",", "4"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]}], "-", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"2", ",", "3"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           RowBox[{"2", " ", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]}]]}], "-", 
         FractionBox["t", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox[
          RowBox[{"2", " ", "t"}], 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"2", ",", "4"}]]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["2", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "+", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"4", ",", "2"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"3", ",", "1"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"4", ",", "2"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]}], "-", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"3", ",", "2"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "t"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]], "+", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["c", 
           RowBox[{"4", ",", "4"}]]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           FractionBox["t", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]]], " ", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"3", ",", "3"}]], "+", 
            SubscriptBox["c", 
             RowBox[{"4", ",", "4"}]]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["t", 
          RowBox[{"2", " ", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "2"}]]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", "t"}], 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"3", ",", "4"}]]}]},
     {
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox["1", "2"], " ", "t", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox["1", 
             SubscriptBox["T", 
              RowBox[{"1", ",", "1"}]]]}], "-", 
           FractionBox["1", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "2"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "1"}]]], "-", 
           FractionBox["4", 
            SubscriptBox["T", 
             RowBox[{"\[Phi]", ",", "2"}]]]}], ")"}]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"4", ",", "1"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           RowBox[{"2", " ", 
            SubscriptBox["T", 
             RowBox[{"1", ",", "1"}]]}]]}], "-", 
         FractionBox["t", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]], "-", 
         FractionBox[
          RowBox[{"2", " ", "t"}], 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "1"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"4", ",", "2"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["t", 
          RowBox[{"2", " ", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "2"}]]}]], "-", 
         FractionBox[
          RowBox[{"2", " ", "t"}], 
          SubscriptBox["T", 
           RowBox[{"\[Phi]", ",", "2"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"4", ",", "3"}]]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["t", 
           SubscriptBox["T", 
            RowBox[{"1", ",", "1"}]]]}], "-", 
         FractionBox["t", 
          SubscriptBox["T", 
           RowBox[{"1", ",", "2"}]]]}]], " ", 
       SubscriptBox["c", 
        RowBox[{"4", ",", "4"}]]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.958823722960821*^9, 3.958824031315102*^9, 
  3.958824084698072*^9, 3.958824114862073*^9},
 CellLabel->
  "Out[173]//MatrixForm=",ExpressionUUID->"ef64121e-d4bf-4561-8578-\
627ee7c94fd3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "E - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalEpsilon]", "1"], "\[SmallCircle]", 
    SubscriptBox["\[CapitalEpsilon]", "2"]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "73cb4e0b-1db5-4c07-b802-005470b1c526"]
}], "Subsubsection",
 CellChangeTimes->{{3.958829656245673*^9, 
  3.958829663725452*^9}},ExpressionUUID->"f19a52d0-a7eb-4100-8241-\
e60e8b237456"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[Rho]", "/.", 
     RowBox[{"exactSolution", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{"\[Rho]", "/.", 
     RowBox[{"solution", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.958824118725868*^9, 3.958824140691638*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"5eaa99a9-49a5-4863-a029-a761abb436d3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.958823992628186*^9, 3.95882401051512*^9}, {
  3.9588241352080936`*^9, 3.958824141061728*^9}},
 CellLabel->
  "Out[175]=",ExpressionUUID->"6f8738af-edf6-4954-862b-fd9ca35b5171"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute density matrix evolved under pure decoherence", "Subsection",
 CellChangeTimes->{{3.958829688912183*^9, 
  3.958829727031464*^9}},ExpressionUUID->"8c4cfcf9-5e81-410d-9057-\
a2582f027bad"],

Cell[TextData[{
 "Denote the relaxation probability for qubit `i` to be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["r", "i"], "=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", 
      SubsuperscriptBox["T", "1", 
       RowBox[{"(", "i", ")"}]]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "06c36afb-7ff1-497b-99e4-0bd177f9e735"],
 " and the non-dephasing probability to be ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d", "i"], "=", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "t"}], "/", 
      SubsuperscriptBox["T", "2", 
       RowBox[{"(", "i", ")"}]]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "b98057d6-dc9a-4823-82c4-0568974c67fc"],
 ". Then, each ",
 Cell[BoxData[
  RowBox[{
   TemplateBox[{"1"},
    "Ket"], 
   TemplateBox[{"1"},
    "Bra"]}]],ExpressionUUID->"3020641e-9276-4455-97e7-db578355c5ac"],
 " element relaxes and ",
 Cell[BoxData[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     TemplateBox[{"0"},
      "Ket"], 
     TemplateBox[{"1"},
      "Bra"]}], ",", 
    RowBox[{
     TemplateBox[{"1"},
      "Ket"], 
     TemplateBox[{"0"},
      "Bra"]}]}], "}"}]],ExpressionUUID->
  "fc5c8a4f-0a8f-4ca0-82dd-d4e613d388b7"],
 " element dephases."
}], "Text",
 CellChangeTimes->{{3.9588297326509323`*^9, 3.958829891077808*^9}, {
  3.959451449350402*^9, 
  3.959451449547481*^9}},ExpressionUUID->"ec2375c9-1eb8-4c9e-8704-\
ab213c87068b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Only", " ", "relaxation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"\[Placeholder]", "00", "01", "10", "11"},
        {"00", 
         SubscriptBox["a", 
          RowBox[{"1", ",", "1"}]], "\[Placeholder]", "\[Placeholder]", 
         "\[Placeholder]"},
        {"01", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"2", ",", "2"}]], "\[Placeholder]", "\[Placeholder]"},
        {"10", "\[Placeholder]", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"3", ",", "3"}]], "\[Placeholder]"},
        {"11", "\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"4", ",", "4"}]]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "->", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"\[Placeholder]", "00", "01", "10", "11"},
        {"00", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"1", ",", "1"}]], "+", 
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"2", ",", "2"}]], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SubscriptBox["r", "2"]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"3", ",", "3"}]], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SubscriptBox["r", "1"]}], ")"}]}], "+", 
          RowBox[{
           SubscriptBox["a", 
            RowBox[{"4", ",", "4"}]], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SubscriptBox["r", "1"]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SubscriptBox["r", "2"]}], ")"}]}]}], "\[Placeholder]", 
         "\[Placeholder]", "\[Placeholder]"},
        {"01", "\[Placeholder]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"2", ",", "2"}]], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"4", ",", "4"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "1"]}], ")"}]}]}], ")"}], 
          RowBox[{"(", 
           SubscriptBox["r", "2"], ")"}]}], "\[Placeholder]", 
         "\[Placeholder]"},
        {"10", "\[Placeholder]", "\[Placeholder]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"3", ",", "3"}]], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"4", ",", "4"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "2"]}], ")"}]}]}], ")"}], 
          SubscriptBox["r", "1"]}], "\[Placeholder]"},
        {"11", "\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"4", ",", "4"}]], 
          RowBox[{"(", 
           SubscriptBox["r", "1"], ")"}], 
          RowBox[{"(", 
           SubscriptBox["r", "2"], ")"}]}]}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Only", " ", "dephasing"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"\[Placeholder]", "00", "01", "10", "11"},
        {"00", "\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"1", ",", "4"}]]},
        {"01", "\[Placeholder]", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"2", ",", "3"}]], "\[Placeholder]"},
        {"10", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"3", ",", "2"}]], "\[Placeholder]", "\[Placeholder]"},
        {"11", 
         SubscriptBox["a", 
          RowBox[{"4", ",", "1"}]], "\[Placeholder]", "\[Placeholder]", 
         "\[Placeholder]"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "->", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"\[Placeholder]", "00", "01", "10", "11"},
        {"00", "\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"1", ",", "4"}]], 
          SubscriptBox["d", "1"], 
          SubscriptBox["d", "2"]}]},
        {"01", "\[Placeholder]", "\[Placeholder]", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"2", ",", "3"}]], 
          SubscriptBox["d", "1"], 
          SubscriptBox["d", "2"]}], "\[Placeholder]"},
        {"10", "\[Placeholder]", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"3", ",", "2"}]], 
          SubscriptBox["d", "1"], 
          SubscriptBox["d", "2"]}], "\[Placeholder]", "\[Placeholder]"},
        {"11", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"4", ",", "1"}]], 
          SubscriptBox["d", "1"], 
          SubscriptBox["d", "2"]}], "\[Placeholder]", "\[Placeholder]", 
         "\[Placeholder]"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Both", " ", "relaxation", " ", "and", " ", "dephasing"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"\[Placeholder]", "00", "01", "10", "11"},
        {"00", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"1", ",", "2"}]], 
         SubscriptBox["a", 
          RowBox[{"1", ",", "3"}]], "\[Placeholder]"},
        {"01", 
         SubscriptBox["a", 
          RowBox[{"2", ",", "1"}]], "\[Placeholder]", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"2", ",", "4"}]]},
        {"10", 
         SubscriptBox["a", 
          RowBox[{"3", ",", "1"}]], "\[Placeholder]", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"3", ",", "4"}]]},
        {"11", "\[Placeholder]", 
         SubscriptBox["a", 
          RowBox[{"4", ",", "2"}]], 
         SubscriptBox["a", 
          RowBox[{"4", ",", "3"}]], "\[Placeholder]"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]], "->", 
    TagBox[
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"\[Placeholder]", "00", "01", "10", "11"},
        {"00", "\[Placeholder]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"1", ",", "2"}]], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"3", ",", "4"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "1"]}], ")"}]}]}], ")"}], 
          SubscriptBox["d", "2"]}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"1", ",", "3"}]], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"2", ",", "4"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "2"]}], ")"}]}]}], ")"}], 
          SubscriptBox["d", "1"]}], "\[Placeholder]"},
        {"01", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"2", ",", "1"}]], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"4", ",", "3"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "1"]}], ")"}]}]}], ")"}], 
          SubscriptBox["d", "2"]}], "\[Placeholder]", "\[Placeholder]", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"2", ",", "4"}]], 
          SubscriptBox["d", "1"], 
          RowBox[{"(", 
           SubscriptBox["r", "2"], ")"}]}]},
        {"10", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"3", ",", "1"}]], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"4", ",", "2"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "2"]}], ")"}]}]}], ")"}], 
          SubscriptBox["d", "1"]}], "\[Placeholder]", "\[Placeholder]", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"3", ",", "4"}]], 
          RowBox[{"(", 
           SubscriptBox["r", "1"], ")"}], 
          SubscriptBox["d", "2"]}]},
        {"11", "\[Placeholder]", 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"4", ",", "2"}]], 
          SubscriptBox["d", "1"], 
          RowBox[{"(", 
           SubscriptBox["r", "2"], ")"}]}], 
         RowBox[{
          SubscriptBox["a", 
           RowBox[{"4", ",", "3"}]], 
          RowBox[{"(", 
           SubscriptBox["r", "1"], ")"}], 
          SubscriptBox["d", "2"]}], "\[Placeholder]"}
       },
       GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}}], "\[NoBreak]", ")"}],
     Function[BoxForm`e$, 
      MatrixForm[BoxForm`e$]]]}]}]}]], "Input",
 CellChangeTimes->{{3.9588299120842876`*^9, 3.9588300150891457`*^9}, {
  3.9588300554698887`*^9, 3.958830585713641*^9}, {3.9594511878749247`*^9, 
  3.959451246868882*^9}},ExpressionUUID->"06813e67-a5f7-4b06-8e81-\
5803d009511c"]
}, Closed]],

Cell[CellGroupData[{

Cell["As a map", "Subsection",
 CellChangeTimes->{{3.95884143732827*^9, 3.9588414404823*^9}, {
  3.958841479907752*^9, 
  3.958841481132159*^9}},ExpressionUUID->"796a2975-e186-46a7-a227-\
a14a5db9d107"],

Cell[TextData[{
 "The code `",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[CapitalEpsilon]", "[", "x_", "]"}], ":=", 
   RowBox[{
    SubscriptBox["a", 
     RowBox[{"1", ",", "1"}]], "/.", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"i_", ",", "j_"}]], "->", 
      RowBox[{"x", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}]}]], "Input",
  ExpressionUUID->"d8f5c825-ecb6-4942-ab2a-67616ff5cbf3"],
 "` will not work because the replacement rule tries to use `i` and `j` \
before it has gotten the values from pattern matching. We need to use delayed \
pattern matching instead `:>`."
}], "Text",
 CellChangeTimes->{{3.9588421060587187`*^9, 3.9588421310763063`*^9}, {
  3.958842213120903*^9, 
  3.9588422720660477`*^9}},ExpressionUUID->"d7661c1d-28a7-4f41-8b18-\
1a94b11a671d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalEpsilon]", "[", "\[Rho]_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"1", ",", "1"}]], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"2", ",", "2"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "2"]}], ")"}]}], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"3", ",", "3"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "1"]}], ")"}]}], "+", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"4", ",", "4"}]], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "1"]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SubscriptBox["r", "2"]}], ")"}]}]}], "\[Placeholder]", 
           "\[Placeholder]", "\[Placeholder]"},
          {"\[Placeholder]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["a", 
               RowBox[{"2", ",", "2"}]], "+", 
              RowBox[{
               SubscriptBox["a", 
                RowBox[{"4", ",", "4"}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SubscriptBox["r", "1"]}], ")"}]}]}], ")"}], 
            RowBox[{"(", 
             SubscriptBox["r", "2"], ")"}]}], "\[Placeholder]", 
           "\[Placeholder]"},
          {"\[Placeholder]", "\[Placeholder]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["a", 
               RowBox[{"3", ",", "3"}]], "+", 
              RowBox[{
               SubscriptBox["a", 
                RowBox[{"4", ",", "4"}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SubscriptBox["r", "2"]}], ")"}]}]}], ")"}], 
            SubscriptBox["r", "1"]}], "\[Placeholder]"},
          {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"4", ",", "4"}]], 
            RowBox[{"(", 
             SubscriptBox["r", "1"], ")"}], 
            RowBox[{"(", 
             SubscriptBox["r", "2"], ")"}]}]}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Placeholder]", "->", "0"}], "}"}]}], ")"}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"\[Placeholder]", "\[Placeholder]", "\[Placeholder]", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"1", ",", "4"}]], 
            SubscriptBox["d", "1"], 
            SubscriptBox["d", "2"]}]},
          {"\[Placeholder]", "\[Placeholder]", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"2", ",", "3"}]], 
            SubscriptBox["d", "1"], 
            SubscriptBox["d", "2"]}], "\[Placeholder]"},
          {"\[Placeholder]", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"3", ",", "2"}]], 
            SubscriptBox["d", "1"], 
            SubscriptBox["d", "2"]}], "\[Placeholder]", "\[Placeholder]"},
          {
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"4", ",", "1"}]], 
            SubscriptBox["d", "1"], 
            SubscriptBox["d", "2"]}], "\[Placeholder]", "\[Placeholder]", 
           "\[Placeholder]"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Placeholder]", "->", "0"}], "}"}]}], ")"}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", GridBox[{
          {"\[Placeholder]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["a", 
               RowBox[{"1", ",", "2"}]], "+", 
              RowBox[{
               SubscriptBox["a", 
                RowBox[{"3", ",", "4"}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SubscriptBox["r", "1"]}], ")"}]}]}], ")"}], 
            SubscriptBox["d", "2"]}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["a", 
               RowBox[{"1", ",", "3"}]], "+", 
              RowBox[{
               SubscriptBox["a", 
                RowBox[{"2", ",", "4"}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SubscriptBox["r", "2"]}], ")"}]}]}], ")"}], 
            SubscriptBox["d", "1"]}], "\[Placeholder]"},
          {
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["a", 
               RowBox[{"2", ",", "1"}]], "+", 
              RowBox[{
               SubscriptBox["a", 
                RowBox[{"4", ",", "3"}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SubscriptBox["r", "1"]}], ")"}]}]}], ")"}], 
            SubscriptBox["d", "2"]}], "\[Placeholder]", "\[Placeholder]", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"2", ",", "4"}]], 
            SubscriptBox["d", "1"], 
            RowBox[{"(", 
             SubscriptBox["r", "2"], ")"}]}]},
          {
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["a", 
               RowBox[{"3", ",", "1"}]], "+", 
              RowBox[{
               SubscriptBox["a", 
                RowBox[{"4", ",", "2"}]], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 SubscriptBox["r", "2"]}], ")"}]}]}], ")"}], 
            SubscriptBox["d", "1"]}], "\[Placeholder]", "\[Placeholder]", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"3", ",", "4"}]], 
            RowBox[{"(", 
             SubscriptBox["r", "1"], ")"}], 
            SubscriptBox["d", "2"]}]},
          {"\[Placeholder]", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"4", ",", "2"}]], 
            SubscriptBox["d", "1"], 
            RowBox[{"(", 
             SubscriptBox["r", "2"], ")"}]}], 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"4", ",", "3"}]], 
            RowBox[{"(", 
             SubscriptBox["r", "1"], ")"}], 
            SubscriptBox["d", "2"]}], "\[Placeholder]"}
         },
         GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.7]}, 
             Offset[0.27999999999999997`]}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\[Placeholder]", "->", "0"}], "}"}]}], ")"}]}], ")"}], "/.", 
   
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["a", 
      RowBox[{"i_", ",", "j_"}]], ":>", 
     RowBox[{"\[Rho]", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.958841443937456*^9, 3.958841533261643*^9}, {
  3.958841565765764*^9, 3.958841616467664*^9}, {3.9588418787870617`*^9, 
  3.9588419531277027`*^9}, {3.958842009447674*^9, 3.95884202049543*^9}, {
  3.958842056653747*^9, 3.958842094315089*^9}, {3.958842196714794*^9, 
  3.9588421975907393`*^9}, {3.959451261366013*^9, 3.959451306524579*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"ddbeacaf-e7e1-4136-b5c9-7f6d4f7677e4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Open system evolution", "Section",
 CellChangeTimes->{{3.958840913706203*^9, 
  3.958840917119389*^9}},ExpressionUUID->"ee2d41f5-2edd-4beb-90f7-\
db849e272c4c"],

Cell["\<\
The sequential application of 4 CZ gates will give us a recurrence relation \
between the state just before and after the gate. Solving the recurrence \
equation will give the general result.\
\>", "Text",
 CellChangeTimes->{{3.958844162925466*^9, 
  3.958844208452677*^9}},ExpressionUUID->"07012183-0e06-4dc7-8809-\
6d9e8f669ff1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleSubstitions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Epsilon]"}], "+", "\[Eta]", "+", "\[Kappa]"}], 
       ")"}]}], ",", 
     RowBox[{"\[Beta]", "->", 
      RowBox[{"(", 
       RowBox[{"\[Epsilon]", "+", "\[Eta]", "-", "\[Kappa]"}], ")"}]}], ",", 
     RowBox[{"\[Gamma]", "->", 
      RowBox[{"(", 
       RowBox[{"\[Epsilon]", "-", "\[Eta]", "+", "\[Kappa]"}], ")"}]}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]n", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"i", ",", "j"}]], "[", "n", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]nplus1", "=", 
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[CapitalEpsilon]", "[", 
       RowBox[{"\[CapitalUpsilon]", "[", 
        RowBox[{"\[CapitalEpsilon]", "[", 
         RowBox[{"\[CapitalUpsilon]", "[", 
          RowBox[{"\[CapitalEpsilon]", "[", 
           RowBox[{"\[CapitalUpsilon]", "[", 
            RowBox[{"\[CapitalEpsilon]", "[", 
             RowBox[{"\[CapitalUpsilon]", "[", "\[Rho]n", "]"}], "]"}], "]"}],
            "]"}], "]"}], "]"}], "]"}], "]"}], "/.", "angleSubstitions"}], 
     ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", ",", "\[Eta]", ",", "\[Kappa]"}], "}"}], 
        "\[Element]", "Reals"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"RSolve", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Rho]n", "/.", 
            RowBox[{"n", "->", 
             RowBox[{"n", "+", "1"}]}]}], ")"}], ",", 
          RowBox[{"{", "16", "}"}]}], "]"}], ",", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Rho]n", "/.", 
            RowBox[{"n", "->", "0"}]}], ")"}], ",", 
          RowBox[{"{", "16", "}"}]}], "]"}]}], "]"}], "==", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"ArrayReshape", "[", 
         RowBox[{"\[Rho]nplus1", ",", 
          RowBox[{"{", "16", "}"}]}], "]"}], ",", 
        RowBox[{"ArrayReshape", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"i", ",", "j"}]], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", "16", "}"}]}], "]"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ArrayReshape", "[", 
      RowBox[{"\[Rho]n", ",", 
       RowBox[{"{", "16", "}"}]}], "]"}], ",", "n"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9588410004364023`*^9, 3.958841116055574*^9}, {
  3.958842290515263*^9, 3.958842417342908*^9}, {3.958843595471034*^9, 
  3.9588437195330133`*^9}, {3.958843789105885*^9, 3.958843790769094*^9}, {
  3.958843822962229*^9, 3.958843978876479*^9}, {3.958844017712322*^9, 
  3.958844052733543*^9}, {3.958844152018107*^9, 3.958844153282168*^9}, {
  3.959170301151845*^9, 3.959170307216021*^9}, {3.9591703506675777`*^9, 
  3.95917039460113*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"e15a4676-6279-409d-ab83-76b66e37d0ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "=", 
  RowBox[{"solution", "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.95884379765357*^9, 3.958843811136092*^9}, {
  3.958843891766433*^9, 3.95884389373671*^9}, {3.959170486308291*^9, 
  3.959170493418626*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"068d1f1e-1779-4e5d-9b14-fbeefc4beee7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "1"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SubscriptBox["b", 
       RowBox[{"1", ",", "1"}]], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubsuperscriptBox["r", "2", 
             RowBox[{"4", " ", "n"}]]}], ")"}], " ", 
          SubscriptBox["b", 
           RowBox[{"2", ",", "2"}]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubsuperscriptBox["r", "1", 
             RowBox[{"4", " ", "n"}]]}], ")"}], " ", 
          SubscriptBox["b", 
           RowBox[{"3", ",", "3"}]]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubsuperscriptBox["r", "1", 
             RowBox[{"4", " ", "n"}]], "+", 
            SubsuperscriptBox["r", "2", 
             RowBox[{"4", " ", "n"}]], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["r", "1", "4"], " ", 
               SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}], ")"}], " ", 
          
          SubscriptBox["b", 
           RowBox[{"4", ",", "4"}]]}]}], ")"}], " ", 
       RowBox[{"UnitStep", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "]"}]}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"2", ",", "2"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["r", "1", "4"], " ", 
           SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}], " ", 
       SubscriptBox["b", 
        RowBox[{"4", ",", "4"}]], " ", 
       RowBox[{"UnitStep", "[", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], "]"}]}], "+", 
      RowBox[{
       SubsuperscriptBox["r", "2", 
        RowBox[{"4", " ", "n"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["b", 
          RowBox[{"2", ",", "2"}]], "+", 
         RowBox[{
          SubscriptBox["b", 
           RowBox[{"4", ",", "4"}]], " ", 
          RowBox[{"UnitStep", "[", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], "]"}]}]}], ")"}]}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"3", ",", "3"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SubsuperscriptBox["r", "1", 
       RowBox[{"4", " ", "n"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"3", ",", "3"}]], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubsuperscriptBox["r", "2", 
            RowBox[{"4", " ", "n"}]]}], ")"}], " ", 
         SubscriptBox["b", 
          RowBox[{"4", ",", "4"}]], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], "]"}]}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"4", ",", "4"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["r", "1", "4"], " ", 
         SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"4", ",", "4"}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "2"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
          SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], " ", 
       SubscriptBox["b", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "1"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
             SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
             SubsuperscriptBox["d", "2", "4"], " ", 
             SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"]}], ")"}], " ", 
        SubscriptBox["b", 
         RowBox[{"3", ",", "4"}]]}], 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
         SubscriptBox["r", "1"]}]}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"3", ",", "4"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"8", " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
         SubsuperscriptBox["d", "2", "4"], " ", 
         SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"3", ",", "4"}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "3"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
          SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], " ", 
       SubscriptBox["b", 
        RowBox[{"1", ",", "3"}]]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Epsilon]"}], "+", "\[Eta]"}], ")"}]}]], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "2"]}], ")"}], " ", 
        SubscriptBox["b", 
         RowBox[{"2", ",", "4"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{
                  RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
                SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{
                  RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
                SubsuperscriptBox["d", "1", "4"], " ", 
                SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}], ")"}], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "+", 
          RowBox[{
           SubsuperscriptBox["d", "1", "4"], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"1", "-", "n"}], "]"}], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], "]"}]}]}], ")"}]}], 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
         SubscriptBox["r", "2"]}]}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"2", ",", "4"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
         SubsuperscriptBox["d", "1", "4"], " ", 
         SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"2", ",", "4"}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"1", ",", "4"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
         SubsuperscriptBox["d", "1", "4"], " ", 
         SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"1", ",", "4"}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"2", ",", "1"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"8", " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
          SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], " ", 
       SubscriptBox["b", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "1"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
             SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
             SubsuperscriptBox["d", "2", "4"], " ", 
             SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"]}], ")"}], " ", 
        SubscriptBox["b", 
         RowBox[{"4", ",", "3"}]], " ", 
        RowBox[{"UnitStep", "[", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], "]"}]}], 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
        SubscriptBox["r", "1"]}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"4", ",", "3"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
         SubsuperscriptBox["d", "2", "4"], " ", 
         SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"4", ",", "3"}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"2", ",", "3"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
         SubsuperscriptBox["d", "1", "4"], " ", 
         SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"2", ",", "3"}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"3", ",", "1"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"8", " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
          SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], " ", 
       SubscriptBox["b", 
        RowBox[{"3", ",", "1"}]]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "2"]}], ")"}], " ", 
        SubscriptBox["b", 
         RowBox[{"4", ",", "2"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"8", " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"\[Eta]", "+", 
                RowBox[{"n", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]}], 
               ")"}]}]]}], " ", 
           SubsuperscriptBox["d", "1", 
            RowBox[{"4", " ", "n"}]], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
              SubsuperscriptBox["d", "1", "4"], " ", 
              SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Epsilon]"}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["r", "2", "4"], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"1", "-", "n"}], "]"}], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], "]"}]}]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
        SubscriptBox["r", "2"]}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"4", ",", "2"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"8", " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
         SubsuperscriptBox["d", "1", "4"], " ", 
         SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"4", ",", "2"}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"3", ",", "2"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"8", " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
         SubsuperscriptBox["d", "1", "4"], " ", 
         SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"3", ",", "2"}]]}]}], ",", 
    RowBox[{
     RowBox[{
      SubscriptBox["a", 
       RowBox[{"4", ",", "1"}]], "[", "n", "]"}], "\[Rule]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"8", " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
         SubsuperscriptBox["d", "1", "4"], " ", 
         SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], " ", 
      SubscriptBox["b", 
       RowBox[{"4", ",", "1"}]]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.9588438041185637`*^9, 3.9588438113906307`*^9}, {
   3.958843888160438*^9, 3.958843921064402*^9}, 3.9588440574285297`*^9, 
   3.9590990812974157`*^9, {3.959170384957861*^9, 3.9591704013022537`*^9}, {
   3.959170489846719*^9, 3.959170495443252*^9}, 3.95945135563239*^9},
 FontSize->14,
 CellLabel->"Out[22]=",ExpressionUUID->"6903ab7c-cce9-4743-ad1b-01a5b7cb3052"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fidelities for various initial states", "Subsection",
 CellChangeTimes->{{3.958844246022048*^9, 
  3.9588442534808903`*^9}},ExpressionUUID->"4adbe8c0-782a-4ae3-863d-\
6556079221db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Rho]n", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"i", ",", "j"}]], "[", "n", "]"}], "/.", 
      RowBox[{"solution", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.958844285216681*^9, 3.9588443088164997`*^9}, {
  3.9588444045532007`*^9, 3.958844405242332*^9}, {3.958844482956485*^9, 
  3.9588444986917267`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"a9ddc569-1d4f-4391-9f30-25bdb07422b1"],

Cell["Confirm that the recurrence relation works for n=0", "Text",
 CellChangeTimes->{{3.959098637040159*^9, 
  3.959098644956407*^9}},ExpressionUUID->"3df44220-16c1-4762-87ed-\
d8b565d31c4c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Rho]n", "/.", 
    RowBox[{"{", 
     RowBox[{"n", "->", "0"}], "}"}]}], "//", "MatrixForm"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.959098620335966*^9, 3.9590986310532627`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0b03e3c7-0ef7-45cb-ad38-d97db32e9428"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      SubscriptBox["b", 
       RowBox[{"1", ",", "1"}]], 
      SubscriptBox["b", 
       RowBox[{"1", ",", "2"}]], 
      SubscriptBox["b", 
       RowBox[{"1", ",", "3"}]], 
      SubscriptBox["b", 
       RowBox[{"1", ",", "4"}]]},
     {
      SubscriptBox["b", 
       RowBox[{"2", ",", "1"}]], 
      SubscriptBox["b", 
       RowBox[{"2", ",", "2"}]], 
      SubscriptBox["b", 
       RowBox[{"2", ",", "3"}]], 
      SubscriptBox["b", 
       RowBox[{"2", ",", "4"}]]},
     {
      SubscriptBox["b", 
       RowBox[{"3", ",", "1"}]], 
      SubscriptBox["b", 
       RowBox[{"3", ",", "2"}]], 
      SubscriptBox["b", 
       RowBox[{"3", ",", "3"}]], 
      SubscriptBox["b", 
       RowBox[{"3", ",", "4"}]]},
     {
      SubscriptBox["b", 
       RowBox[{"4", ",", "1"}]], 
      SubscriptBox["b", 
       RowBox[{"4", ",", "2"}]], 
      SubscriptBox["b", 
       RowBox[{"4", ",", "3"}]], 
      SubscriptBox["b", 
       RowBox[{"4", ",", "4"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.959098627834299*^9, 3.959098631269916*^9}, 
   3.959099086214959*^9, 3.95917064652313*^9, 3.959451401124346*^9},
 CellLabel->
  "Out[24]//MatrixForm=",ExpressionUUID->"e7571773-95dd-4f19-b0bd-\
5248f34f8a67"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Epsilon]", ",", "\[Eta]", ",", "\[Kappa]", ",", "\[Alpha]", ",", 
       "\[Beta]", ",", "\[Gamma]"}], "}"}], "\[Element]", "Reals"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A_", "\[CircleTimes]", "B_"}], ":=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"A", ",", "B"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"simplifyingRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["r", "1"], "->", "0"}], ",", 
     RowBox[{
      SubscriptBox["r", "2"], "->", "0"}], ",", 
     RowBox[{
      SubscriptBox["d", "1"], "->", "1"}], ",", 
     RowBox[{
      SubscriptBox["d", "2"], "->", "1"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"angleSubstitions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "->", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Epsilon]"}], "+", "\[Eta]", "+", "\[Kappa]"}], 
       ")"}]}], ",", 
     RowBox[{"\[Beta]", "->", 
      RowBox[{"(", 
       RowBox[{"\[Epsilon]", "+", "\[Eta]", "-", "\[Kappa]"}], ")"}]}], ",", 
     RowBox[{"\[Gamma]", "->", " ", 
      RowBox[{"(", 
       RowBox[{"\[Epsilon]", "-", "\[Eta]", "+", "\[Kappa]"}], ")"}]}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.958844261910008*^9, 3.958844262629517*^9}, {
   3.9588443288857927`*^9, 3.958844376453793*^9}, {3.95884442598*^9, 
   3.958844428427286*^9}, {3.958844512045794*^9, 3.9588445593618298`*^9}, 
   3.958844670683649*^9, {3.958844714881248*^9, 3.958844721662175*^9}, {
   3.95909867931285*^9, 3.9590986841395693`*^9}, {3.9590991151724157`*^9, 
   3.959099115487302*^9}, {3.9591018566350107`*^9, 3.959101872637628*^9}, {
   3.9591706682372227`*^9, 3.959170687738974*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"f1b1ceb2-8644-4440-a140-853944ac2d6c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Clear", "[", "\[Rho]initial", "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"fidelity", "[", "state_", "]"}], ":=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Refine", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"state", ".", 
            RowBox[{"(", 
             RowBox[{"\[Rho]n", "/.", 
              RowBox[{
               SubscriptBox["b", 
                RowBox[{"i_", ",", "j_"}]], ":>", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ")"}], ".", 
            "state"}], "/.", "angleSubstitions"}], ",", 
          RowBox[{"n", "\[Element]", "Integers"}]}], "]"}], "&"}], "[", 
       RowBox[{
        RowBox[{"ArrayReshape", "[", 
         RowBox[{"state", ",", " ", 
          RowBox[{"{", 
           RowBox[{"4", ",", "1"}], "}"}]}], "]"}], ".", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"ArrayReshape", "[", 
          RowBox[{"state", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"letteredStates", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<00\>\"", ",", "\"\<01\>\"", ",", "\"\<10\>\"", ",", "\"\<11\>\"", 
       ",", "\"\<0+\>\"", ",", "\"\<+0\>\"", ",", "\"\<++\>\"", ",", 
       "\"\<00+11\>\"", ",", "\"\<00-11\>\"", ",", "\"\<01+10\>\"", ",", 
       "\"\<01-10\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"states", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "\[CircleTimes]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "\[CircleTimes]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "\[CircleTimes]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], "\[CircleTimes]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "\[CircleTimes]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "/", 
          SqrtBox["2"]}]}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "/", 
          SqrtBox["2"]}], "\[CircleTimes]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "/", 
          SqrtBox["2"]}], "\[CircleTimes]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "/", 
          SqrtBox["2"]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], "/", 
        SqrtBox["2"]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", 
          RowBox[{"-", "1"}]}], "}"}], "/", 
        SqrtBox["2"]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}], "/", 
        SqrtBox["2"]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", 
          RowBox[{"-", "1"}], ",", "0"}], "}"}], "/", 
        SqrtBox["2"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Assume", " ", "n", " ", "is", " ", "greater", " ", "than", " ", "equal",
       " ", "to", " ", "1.", " ", "Hopefully", " ", "n"}], "=", 
     RowBox[{
     "0", " ", "should", " ", "not", " ", "affect", " ", "the", " ", "fit", 
      " ", 
      RowBox[{"statistics", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"letteredStates", ",", 
        RowBox[{"Simplify", "[", 
         RowBox[{"Refine", "[", 
          RowBox[{
           RowBox[{"fidelity", "/@", "states"}], ",", 
           RowBox[{"Assumptions", "->", 
            RowBox[{"{", 
             RowBox[{"n", ">=", "1"}], "}"}]}]}], "]"}], "]"}]}], "}"}], 
      "]"}], ",", 
     RowBox[{"Frame", "->", "All"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.959170926991288*^9, 3.9591709636170177`*^9}, {
  3.959172603695053*^9, 3.959172661448175*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"1503b701-fd4a-4eae-9e34-631f6673e5f9"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"00\"\>", "1"},
    {"\<\"01\"\>", 
     SubsuperscriptBox["r", "2", 
      RowBox[{"4", " ", "n"}]]},
    {"\<\"10\"\>", 
     SubsuperscriptBox["r", "1", 
      RowBox[{"4", " ", "n"}]]},
    {"\<\"11\"\>", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["r", "1", "4"], " ", 
        SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]},
    {"\<\"0+\"\>", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"]}], ")"}]}]},
    {"\<\"+0\"\>", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"]}], ")"}]}]},
    {"\<\"++\"\>", 
     RowBox[{
      FractionBox["1", "16"], " ", 
      RowBox[{"(", 
       RowBox[{"4", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
        SubsuperscriptBox["r", "1", 
         RowBox[{"4", " ", "n"}]], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"], " ", 
           SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"], " ", 
           SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["r", "1"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
               SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
               SubsuperscriptBox["d", "2", "4"], " ", 
               SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"]}], ")"}]}], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
          SubscriptBox["r", "1"]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["r", "1"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{
                 RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
               SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
               SubsuperscriptBox["d", "2", "4"], " ", 
               SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"]}], ")"}]}], 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
           SubscriptBox["r", "1"]}]}]], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["r", "1", "4"], " ", 
           SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], "-", 
        RowBox[{
         SubsuperscriptBox["r", "1", 
          RowBox[{"4", " ", "n"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubsuperscriptBox["r", "2", 
            RowBox[{"4", " ", "n"}]]}], ")"}]}], "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["r", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Epsilon]"}]], " ", 
             SubsuperscriptBox["d", "1", "4"], " ", 
             SubsuperscriptBox["r", "2", "4"], " ", 
             RowBox[{"UnitStep", "[", 
              RowBox[{"1", "-", "n"}], "]"}]}], "-", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]}], ")"}]}]],
              " ", 
             SubsuperscriptBox["d", "1", 
              RowBox[{"4", " ", "n"}]], " ", 
             RowBox[{"UnitStep", "[", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
                SubsuperscriptBox["d", "1", "4"], " ", 
                SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], " ", 
             RowBox[{"UnitStep", "[", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], "]"}]}]}], ")"}]}], 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
          SubscriptBox["r", "2"]}]], "+", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "\[Epsilon]"}], "+", "\[Eta]"}], ")"}]}]], 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["r", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubsuperscriptBox["d", "1", "4"], " ", 
             RowBox[{"UnitStep", "[", 
              RowBox[{"1", "-", "n"}], "]"}]}], "+", 
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
                  SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
                  SubsuperscriptBox["d", "1", "4"], " ", 
                  SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}], ")"}], 
             " ", 
             RowBox[{"UnitStep", "[", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], "]"}]}]}], ")"}]}], 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
           SubscriptBox["r", "2"]}]}]]}], ")"}]}]},
    {"\<\"00+11\"\>", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
        SubsuperscriptBox["r", "1", 
         RowBox[{"4", " ", "n"}]], "-", 
        SubsuperscriptBox["r", "2", 
         RowBox[{"4", " ", "n"}]], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["r", "1", "4"], " ", 
            SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}]}], ")"}]}]},
    {"\<\"00-11\"\>", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
        SubsuperscriptBox["r", "1", 
         RowBox[{"4", " ", "n"}]], "-", 
        SubsuperscriptBox["r", "2", 
         RowBox[{"4", " ", "n"}]], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["r", "1", "4"], " ", 
            SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}]}], ")"}]}]},
    {"\<\"01+10\"\>", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SubsuperscriptBox["r", "1", 
         RowBox[{"4", " ", "n"}]], "+", 
        SubsuperscriptBox["r", "2", 
         RowBox[{"4", " ", "n"}]]}], ")"}]}]},
    {"\<\"01-10\"\>", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "1", "4"], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
        SubsuperscriptBox["r", "1", 
         RowBox[{"4", " ", "n"}]], "+", 
        SubsuperscriptBox["r", "2", 
         RowBox[{"4", " ", "n"}]]}], ")"}]}]}
   },
   AutoDelete->False,
   GridBoxFrame->{"Columns" -> {{True}}, "Rows" -> {{True}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output",
 CellChangeTimes->{3.959170719028297*^9, 3.959170991442471*^9, 
  3.95945143545642*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"0810b75b-69b2-4865-bf60-7a73b57cb8fc"]
}, Open  ]],

Cell[TextData[{
 "Fidelity with ",
 Cell[BoxData[
  TemplateBox[{"++"},
   "Ket"]],ExpressionUUID->"d95f14d5-4dde-4ab1-b8c3-2509684aa8e6"],
 " state simplifies from the cumbersome expression above to\n",
 Cell[BoxData[
  RowBox[{
   FractionBox["1", "16"], " ", 
   RowBox[{"(", 
    RowBox[{"4", "+", "\[IndentingNewLine]", 
     RowBox[{
      SubsuperscriptBox["d", "1", 
       RowBox[{"4", "n"}]], "*", "2", 
      RowBox[{"Cos", "[", 
       RowBox[{"8", "  ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}], "n"}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      SubsuperscriptBox["d", "2", 
       RowBox[{"4", "n"}]], "*", "2", 
      RowBox[{"Cos", "[", 
       RowBox[{"8", "  ", 
        RowBox[{"(", 
         RowBox[{"\[Kappa]", "+", "\[Eta]"}], ")"}], "n"}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      SubsuperscriptBox["d", "1", 
       RowBox[{"4", "n"}]], " ", 
      SubsuperscriptBox["d", "2", 
       RowBox[{"4", "n"}]], "*", "2", 
      RowBox[{"Cos", "[", 
       RowBox[{"8", "  ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}], "n"}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      SubsuperscriptBox["d", "1", 
       RowBox[{"4", "n"}]], " ", 
      SubsuperscriptBox["d", "2", 
       RowBox[{"4", "n"}]], "*", "2", 
      RowBox[{"Cos", "[", 
       RowBox[{"8", "  ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}], "n"}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      SubsuperscriptBox["d", "2", 
       RowBox[{"4", "n"}]], " ", 
      SubsuperscriptBox["r", "1", 
       RowBox[{"4", "n"}]], "*", "2", 
      RowBox[{"Cos", "[", 
       RowBox[{"8", "  ", 
        RowBox[{"(", 
         RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}], "n"}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{
      SubsuperscriptBox["d", "1", 
       RowBox[{"4", "n"}]], " ", 
      SubsuperscriptBox["r", "2", 
       RowBox[{"4", "n"}]], "*", "2", 
      RowBox[{"Cos", "[", 
       RowBox[{"8", "  ", 
        RowBox[{"(", 
         RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}], "n"}], "]"}]}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"2", "*", 
      RowBox[{"Re", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["r", "1"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
              SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
              SubsuperscriptBox["d", "2", "4"], " ", 
              SubsuperscriptBox["r", "1", "4"]}], ")"}], "n"]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
         SubscriptBox["r", "1"]}]], "]"}]}], "\[IndentingNewLine]", "+", 
     RowBox[{"2", "*", 
      RowBox[{"Re", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["r", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Eta]", "+", "\[Epsilon]"}], ")"}]}]], " ", 
              SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Eta]", "-", "\[Epsilon]"}], ")"}]}]], " ", 
              SubsuperscriptBox["d", "1", "4"], " ", 
              SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
         SubscriptBox["r", "2"]}]], "]"}]}]}], ")"}]}]],
  CellChangeTimes->{{3.959451744422244*^9, 3.959451746604547*^9}, {
    3.9594518585683823`*^9, 3.9594518785554857`*^9}, {3.959452032993321*^9, 
    3.9594521389222507`*^9}, {3.9594525666349297`*^9, 3.959452583424026*^9}, {
    3.9594526774783583`*^9, 3.95945269794108*^9}, {3.959685007891761*^9, 
    3.959685138436696*^9}, 3.959685242758254*^9, {3.959685704376257*^9, 
    3.959685724541185*^9}, {3.959686605037846*^9, 3.959686661614271*^9}},
  ExpressionUUID->"18090e7f-2ab8-405d-a994-0763fa92fbcc"]
}], "Text",
 CellChangeTimes->{{3.959686703074482*^9, 3.959686729367782*^9}, {
  3.95968676677839*^9, 3.959686766778632*^9}, {3.959687150559866*^9, 
  3.959687154520817*^9}},ExpressionUUID->"308468b7-9724-4419-920f-\
67b8a178ccee"],

Cell[TextData[{
 "Fidelity with ",
 Cell[BoxData[
  TemplateBox[{"++"},
   "Ket"]],ExpressionUUID->"a3018109-dc85-47a8-99b2-162fc092ba45"],
 " state:"
}], "Text",
 CellChangeTimes->{{3.959170788709139*^9, 
  3.95917079845368*^9}},ExpressionUUID->"df2287d3-f33b-4e3a-bf92-\
34b4773b20ba"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"state", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "/", "2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plusPlusFidelity", "=", 
  RowBox[{
   RowBox[{"Refine", "[", 
    RowBox[{
     RowBox[{"state", ".", 
      RowBox[{"(", 
       RowBox[{"\[Rho]n", "/.", 
        RowBox[{
         SubscriptBox["b", 
          RowBox[{"i_", ",", "j_"}]], ":>", 
         RowBox[{"1", "/", "4"}]}]}], ")"}], ".", "state"}], ",", 
     RowBox[{"n", "\[Element]", "Integers"}]}], "]"}], "//", 
   "Simplify"}]}]}], "Input",
 CellLabel->
  "In[330]:=",ExpressionUUID->"981595c1-db0c-4a3d-b1ac-06f62f5ea18c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"8", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"8", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "1", "4"], " ", 
       SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"8", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "1", "4"], " ", 
       SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "1", "4"], " ", 
       SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"8", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "1", "4"], " ", 
       SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["r", "1"]}], ")"}], 
     RowBox[{"4", " ", "n"}]], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "2", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "1"]}], ")"}], "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"8", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "2", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "1"]}], ")"}], "4"]}], ")"}], "n"], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["r", "1"]}], ")"}], "4"]}], ")"}], "n"]}], ")"}], 
      " ", 
      SubscriptBox["r", "1"]}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
       SubscriptBox["r", "1"]}]}]], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["r", "2"]}], ")"}], 
     RowBox[{"4", " ", "n"}]], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "1", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "2"]}], ")"}], "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"8", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
       SubsuperscriptBox["d", "1", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "2"]}], ")"}], "4"]}], ")"}], "n"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "1"]}], ")"}], "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "2"]}], ")"}], "4"]}], ")"}], "n"], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"]}], ")"}], "n"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], " ", 
           SubsuperscriptBox["d", "2", "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SubscriptBox["r", "1"]}], ")"}], "4"]}], ")"}], "n"]}], ")"}], 
      " ", 
      SubscriptBox["r", "1"], " ", 
      RowBox[{"UnitStep", "[", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], "]"}]}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "-", 
      SubscriptBox["r", "1"]}]], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["r", "1"]}], ")"}], 
      RowBox[{"4", " ", "n"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "2"]}], ")"}], 
        RowBox[{"4", " ", "n"}]]}], ")"}], " ", 
     RowBox[{"UnitStep", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "2"]}], ")"}], 
        RowBox[{"4", " ", "n"}]], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SubscriptBox["r", "1"]}], ")"}], "4"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SubscriptBox["r", "2"]}], ")"}], "4"]}], ")"}], "n"]}], ")"}], 
     " ", 
     RowBox[{"UnitStep", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["r", "1"]}], ")"}], 
         RowBox[{"4", " ", "n"}]]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["r", "2"]}], ")"}], 
         RowBox[{"4", " ", "n"}]]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SubscriptBox["r", "1"]}], ")"}], "4"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SubscriptBox["r", "2"]}], ")"}], "4"]}], ")"}], "n"]}], ")"}], 
     " ", 
     RowBox[{"UnitStep", "[", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], "]"}]}], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "\[Epsilon]"}], "+", "\[Eta]"}], ")"}]}]], " ", 
      SubscriptBox["r", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["d", "1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
            SubsuperscriptBox["d", "1", "4"]}], ")"}], 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}]], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"8", " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
            SubsuperscriptBox["d", "1", "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["r", "2"]}], ")"}], "4"]}], ")"}], "n"], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["d", "1", "4"], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"1", "-", "n"}], "]"}], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], "]"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
       SubscriptBox["r", "2"]}]}]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
      SubscriptBox["r", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"8", " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{"\[Eta]", "+", 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]}], ")"}]}]]}], 
         " ", 
         SubsuperscriptBox["d", "1", 
          RowBox[{"4", " ", "n"}]], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"8", " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
            SubsuperscriptBox["d", "1", "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["r", "2"]}], ")"}], "4"]}], ")"}], "n"], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Epsilon]"}]], " ", 
         SubsuperscriptBox["d", "1", "4"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["r", "2"]}], ")"}], "4"], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{"1", "-", "n"}], "]"}], " ", 
         RowBox[{"UnitStep", "[", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], "]"}]}]}], ")"}]}], 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "-", 
      SubscriptBox["r", "2"]}]]}], ")"}]}]], "Output",
 CellChangeTimes->{3.959170816268489*^9},
 CellLabel->
  "Out[331]=",ExpressionUUID->"ce2717e6-761b-466b-8df8-22f7f483f4c8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Epsilon]", ",", "\[Eta]", ",", "\[Kappa]", ",", "\[Alpha]", ",", 
       "\[Beta]", ",", "\[Gamma]"}], "}"}], "\[Element]", "Reals"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numericalRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Epsilon]", "->", "0.1"}], ",", 
     RowBox[{"\[Eta]", "->", "0.01"}], ",", 
     RowBox[{"\[Kappa]", "->", "0.5"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DiscretePlot", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[ImaginaryI]", " ", "4", "k", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "\[Epsilon]"}], "+", "\[Eta]", "+", "\[Kappa]"}], 
              ")"}]}], "]"}], "+", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[ImaginaryI]", " ", "4", "k", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Eta]", "+", "\[Kappa]"}], ")"}]}],
             "]"}], "+", 
           RowBox[{"Exp", " ", "[", 
            RowBox[{"\[ImaginaryI]", " ", "4", "k", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Eta]", "-", "\[Kappa]"}], ")"}]}],
             "]"}], "+", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[ImaginaryI]"}], " ", "4", "k", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Eta]", "+", "\[Kappa]"}], ")"}]}],
             "]"}]}], ")"}], "/", "4"}], "]"}], "2"], "/.", 
      "numericalRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"k", " ", "\[Epsilon]"}], "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{"k", " ", "\[Eta]"}], "]"}], 
          RowBox[{"Cos", "[", 
           RowBox[{"k", " ", "\[Kappa]"}], "]"}]}], "+", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"k", " ", "\[Epsilon]"}], "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{"k", " ", "\[Eta]"}], "]"}], 
          RowBox[{"Sin", "[", 
           RowBox[{"k", " ", "\[Kappa]"}], "]"}]}]}], "]"}], "2"], "/.", 
      "numericalRules"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"plusPlusFidelity", "/.", "angleSubstitions"}], "/.", 
        "simplifyingRules"}], "/.", "numericalRules"}], "/.", 
      RowBox[{"n", "->", "k"}]}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         FractionBox["1", "16"], " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], ")"}], "n"], 
           "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], ")"}], "n"], 
           "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], ")"}], "n"], 
           "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], ")"}], "n"], 
           "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], ")"}], 
            "n"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "-", "\[Kappa]"}], ")"}]}]], ")"}], 
            "n"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], ")"}], "n"], 
           "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "-", "\[Kappa]"}], ")"}]}]], ")"}], "n"], 
           "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], ")"}], 
            "n"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Epsilon]", "+", "\[Kappa]"}], ")"}]}]], ")"}], 
            "n"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{
               RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], ")"}], "n"], 
           "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"8", " ", "\[ImaginaryI]", " ", 
               RowBox[{"(", 
                RowBox[{"\[Eta]", "+", "\[Kappa]"}], ")"}]}]], ")"}], "n"]}], 
          ")"}]}], "]"}], "/.", 
       RowBox[{"n", "->", "k"}]}], "/.", "numericalRules"}], "*)"}], 
    "\[IndentingNewLine]", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "0", ",", "100"}], "}"}], ",", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Basic version\>\"", ",", "\"\<(Incorrect?) simplified formula\>\"", 
      ",", " ", "\"\<From recursion\>\""}], "}"}]}], ",", 
   RowBox[{"PlotMarkers", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Medium"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Small"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Small"}], "}"}]}], "}"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.958847620619892*^9, 3.958847778215259*^9}, {
   3.958847822600198*^9, 3.958847883158169*^9}, {3.9588480305474463`*^9, 
   3.958848191599154*^9}, {3.9588482318356028`*^9, 3.958848309873107*^9}, {
   3.9588483479517736`*^9, 3.958848371150667*^9}, {3.958848411665887*^9, 
   3.958848588425699*^9}, {3.958848832668496*^9, 3.9588488489417353`*^9}, 
   3.95886538824191*^9, {3.959099284740367*^9, 3.959099300994195*^9}, {
   3.959099467271202*^9, 3.959099471413456*^9}, {3.959100061584826*^9, 
   3.959100095158753*^9}, {3.959100395900856*^9, 3.959100418446546*^9}, {
   3.9591008391265907`*^9, 3.959100907414307*^9}, {3.9591011484439096`*^9, 
   3.9591012049834433`*^9}, {3.9591012433218927`*^9, 3.959101247624248*^9}, {
   3.9591017026399603`*^9, 3.959101781457603*^9}, {3.9591018177315397`*^9, 
   3.959101848283757*^9}},
 CellLabel->
  "In[332]:=",ExpressionUUID->"ee5ab003-8b1d-4e61-8483-b79581776a74"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{{{
        Directive[
         PointSize[0.004766666666666667], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        TagBox[{{{
            Directive[
             Opacity[0.2], 
             PointSize[0.004766666666666667], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[1.6]], 
            LineBox[{}, VertexColors -> None]}, {
            Directive[
             Opacity[0.2], 
             PointSize[0.004766666666666667], 
             RGBColor[0.368417, 0.506779, 0.709798], 
             AbsoluteThickness[1.6]], 
            
            LineBox[{{{0., 1.}, {0., 0}}, {{1., 0.14688186597535335`}, {
               1., 0}}, {{2., 0.20794509082418158`}, {2., 0}}, {{3., 
               0.1202890677549246}, {3., 0}}, {{4., 0.024841350035180707`}, {
               4., 0}}, {{5., 0.12677064745977795`}, {5., 0}}, {{6., 
               0.37274275296373804`}, {6., 0}}, {{7., 
               0.023741287500788043`}, {7., 0}}, {{8., 0.8235736223129251}, {
               8., 0}}, {{9., 0.32082782245365615`}, {9., 0}}, {{10., 
               0.13275210962045766`}, {10., 0}}, {{11., 
               0.07732413584071962}, {11., 0}}, {{12., 
               0.17461715475829326`}, {12., 0}}, {{13., 0.1812361080132094}, {
               13., 0}}, {{14., 0.4083466277988308}, {14., 0}}, {{15., 
               0.03924133320083601}, {15., 0}}, {{16., 0.4431221989612531}, {
               16., 0}}, {{17., 0.3560965353505794}, {17., 0}}, {{18., 
               0.2728174346119375}, {18., 0}}, {{19., 0.069310670807091}, {
               19., 0}}, {{20., 0.2842249611775584}, {20., 0}}, {{21., 
               0.3593984196632498}, {21., 0}}, {{22., 0.267050704440778}, {
               22., 0}}, {{23., 0.09071820172197986}, {23., 0}}, {{24., 
               0.1427290880419849}, {24., 0}}, {{25., 0.2058058833677649}, {
               25., 0}}, {{26., 0.4982854468345316}, {26., 0}}, {{27., 
               0.23947744720489011`}, {27., 0}}, {{28., 
               0.21699430698890965`}, {28., 0}}, {{29., 0.5617252498850682}, {
               29., 0}}, {{30., 0.10804990265406175`}, {30., 0}}, {{31., 
               0.059944155532215555`}, {31., 0}}, {{32., 
               0.05358378437211796}, {32., 0}}, {{33., 0.0402039523953481}, {
               33., 0}}, {{34., 0.5713227883021007}, {34., 0}}, {{35., 
               0.5709474069966575}, {35., 0}}, {{36., 0.06012956911331653}, {
               36., 0}}, {{37., 0.5981540872330645}, {37., 0}}, {{38., 
               0.07696174886032257}, {38., 0}}, {{39., 
               0.0031516946158519194`}, {39., 0}}, {{40., 
               0.08181801487685256}, {40., 0}}, {{41., 
               0.042314815986271556`}, {41., 0}}, {{42., 
               0.41961833151098765`}, {42., 0}}, {{43., 0.8287895825413181}, {
               43., 0}}, {{44., 0.004610265312133707}, {44., 0}}, {{45., 
               0.4320019444893564}, {45., 0}}, {{46., 0.12913841600434114`}, {
               46., 0}}, {{47., 0.08694929890756133}, {47., 0}}, {{48., 
               0.10404109095821641`}, {48., 0}}, {{49., 
               0.18258450392981043`}, {49., 0}}, {{50., 
               0.19814217248709873`}, {50., 0}}, {{51., 0.7870018507570385}, {
               51., 0}}, {{52., 0.09729003337558835}, {52., 0}}, {{53., 
               0.25801117771019344`}, {53., 0}}, {{54., 
               0.12351464825306192`}, {54., 0}}, {{55., 0.3456286662642293}, {
               55., 0}}, {{56., 0.14437809097042237`}, {56., 0}}, {{57., 
               0.26332271455058187`}, {57., 0}}, {{58., 
               0.08116426250667422}, {58., 0}}, {{59., 
               0.47777921891526565`}, {59., 0}}, {{60., 
               0.19098662386415505`}, {60., 0}}, {{61., 0.2885522734566048}, {
               61., 0}}, {{62., 0.04471111468951103}, {62., 0}}, {{63., 
               0.5864306554377025}, {63., 0}}, {{64., 0.2990340067690179}, {
               64., 0}}, {{65., 0.17513572045643164`}, {65., 0}}, {{66., 
               0.06908513453139534}, {66., 0}}, {{67., 
               0.15583990361251557`}, {67., 0}}, {{68., 
               0.15176024153629283`}, {68., 0}}, {{69., 0.5010162658736047}, {
               69., 0}}, {{70., 0.04010297293622473}, {70., 0}}, {{71., 
               0.5878529801228388}, {71., 0}}, {{72., 0.5338958053475468}, {
               72., 0}}, {{73., 0.03304774092138497}, {73., 0}}, {{74., 
               0.05396576737787859}, {74., 0}}, {{75., 
               0.021337486335686582`}, {75., 0}}, {{76., 
               0.041884949495913905`}, {76., 0}}, {{77., 
               0.6611810740636457}, {77., 0}}, {{78., 0.21216193427031124`}, {
               78., 0}}, {{79., 0.35426712853911313`}, {79., 0}}, {{80., 
               0.6602140905211822}, {80., 0}}, {{81., 0.01935064566233564}, {
               81., 0}}, {{82., 0.02834563928624717}, {82., 0}}, {{83., 
               0.040282157051756036`}, {83., 0}}, {{84., 
               0.03300119763833042}, {84., 0}}, {{85., 0.5943689168581628}, {
               85., 0}}, {{86., 0.44465185994567813`}, {86., 0}}, {{87., 
               0.1087389373820991}, {87., 0}}, {{88., 0.5509686805684174}, {
               88., 0}}, {{89., 0.14359740968536847`}, {89., 0}}, {{90., 
               0.12834708996074262`}, {90., 0}}, {{91., 
               0.06251109226758894}, {91., 0}}, {{92., 
               0.16686254491065317`}, {92., 0}}, {{93., 0.3694208538871477}, {
               93., 0}}, {{94., 0.5094935752045977}, {94., 0}}, {{95., 
               0.03524701848909018}, {95., 0}}, {{96., 
               0.32111013445878733`}, {96., 0}}, {{97., 
               0.23450923669079984`}, {97., 0}}, {{98., 0.4333544111803372}, {
               98., 0}}, {{99., 0.05177460729886354}, {99., 0}}, {{100., 
               0.28761949944103593`}, {100., 0}}}, VertexColors -> None]}}}, 
         Annotation[#, "Charting`Private`Tag$472294#1"]& ]}, {
        Directive[
         PointSize[0.004766666666666667], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        TagBox[{{{
            Directive[
             Opacity[0.2], 
             PointSize[0.004766666666666667], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[1.6]], 
            LineBox[{}, VertexColors -> None]}, {
            Directive[
             Opacity[0.2], 
             PointSize[0.004766666666666667], 
             RGBColor[0.880722, 0.611041, 0.142051], 
             AbsoluteThickness[1.6]], 
            
            LineBox[{{{0., 1.}, {0., 0}}, {{1., 0.7623992629950541}, {
               1., 0}}, {{2., 0.2803034152657873}, {2., 0}}, {{3., 
               0.004640836463633234}, {3., 0}}, {{4., 0.1468818659753534}, {
               4., 0}}, {{5., 0.493277858452319}, {5., 0}}, {{6., 
               0.665235602343918}, {6., 0}}, {{7., 0.510742216939667}, {
               7., 0}}, {{8., 0.20794509082418153`}, {8., 0}}, {{9., 
               0.021767398680696905`}, {9., 0}}, {{10., 
               0.029744848605436584`}, {10., 0}}, {{11., 
               0.10684943997743505`}, {11., 0}}, {{12., 0.1202890677549246}, {
               12., 0}}, {{13., 0.06781945758661001}, {13., 0}}, {{14., 
               0.024261820196075277`}, {14., 0}}, {{15., 
               0.020137948505904366`}, {15., 0}}, {{16., 
               0.024841350035180735`}, {16., 0}}, {{17., 
               0.023790597620814813`}, {17., 0}}, {{18., 
               0.04664259771239569}, {18., 0}}, {{19., 
               0.10039946059925534`}, {19., 0}}, {{20., 
               0.12677064745977812`}, {20., 0}}, {{21., 
               0.08018823333976016}, {21., 0}}, {{22., 
               0.031136171132839768`}, {22., 0}}, {{23., 
               0.12045441479176598`}, {23., 0}}, {{24., 0.3727427529637382}, {
               24., 0}}, {{25., 0.5999915115672041}, {25., 0}}, {{26., 
               0.5677723091178423}, {26., 0}}, {{27., 0.2770982941479348}, {
               27., 0}}, {{28., 0.023741287500787862`}, {28., 0}}, {{29., 
               0.11314056894629053`}, {29., 0}}, {{30., 0.5169699020122641}, {
               30., 0}}, {{31., 0.8667831274551977}, {31., 0}}, {{32., 
               0.8235736223129244}, {32., 0}}, {{33., 0.4318929601676318}, {
               33., 0}}, {{34., 0.06961245183696563}, {34., 0}}, {{35., 
               0.051034683946387584`}, {35., 0}}, {{36., 0.320827822453656}, {
               36., 0}}, {{37., 0.556189477917135}, {37., 0}}, {{38., 
               0.5285914013823783}, {38., 0}}, {{39., 0.3105761352281607}, {
               39., 0}}, {{40., 0.1327521096204577}, {40., 0}}, {{41., 
               0.10747462069495854`}, {41., 0}}, {{42., 0.148531658686384}, {
               42., 0}}, {{43., 0.13564695036165075`}, {43., 0}}, {{44., 
               0.07732413584071926}, {44., 0}}, {{45., 0.0703852425937544}, {
               45., 0}}, {{46., 0.14222597179814728`}, {46., 0}}, {{47., 
               0.20428907561420404`}, {47., 0}}, {{48., 
               0.17461715475829295`}, {48., 0}}, {{49., 
               0.09237230317278797}, {49., 0}}, {{50., 0.06458639182417189}, {
               50., 0}}, {{51., 0.121125165869834}, {51., 0}}, {{52., 
               0.1812361080132097}, {52., 0}}, {{53., 0.17913638162017356`}, {
               53., 0}}, {{54., 0.1696723146016426}, {54., 0}}, {{55., 
               0.253035504150701}, {55., 0}}, {{56., 0.4083466277988311}, {
               56., 0}}, {{57., 0.4735471104308274}, {57., 0}}, {{58., 
               0.33556567189315567`}, {58., 0}}, {{59., 
               0.10629894511965894`}, {59., 0}}, {{60., 
               0.03924133320083606}, {60., 0}}, {{61., 
               0.24779283254843273`}, {61., 0}}, {{62., 0.5508179496002759}, {
               62., 0}}, {{63., 0.6481217452463417}, {63., 0}}, {{64., 
               0.4431221989612522}, {64., 0}}, {{65., 0.14547206692378348`}, {
               65., 0}}, {{66., 0.03657820205746416}, {66., 0}}, {{67., 
               0.17182087036515997`}, {67., 0}}, {{68., 0.3560965353505795}, {
               68., 0}}, {{69., 0.3949379257743332}, {69., 0}}, {{70., 
               0.30437064896674265`}, {70., 0}}, {{71., 0.2408870172223185}, {
               71., 0}}, {{72., 0.2728174346119374}, {72., 0}}, {{73., 
               0.29948263074006254`}, {73., 0}}, {{74., 
               0.21352704710572132`}, {74., 0}}, {{75., 
               0.07780515252135171}, {75., 0}}, {{76., 0.06931067080709123}, {
               76., 0}}, {{77., 0.24980529241723937`}, {77., 0}}, {{78., 
               0.45820361037295537`}, {78., 0}}, {{79., 0.4773973862390756}, {
               79., 0}}, {{80., 0.2842249611775582}, {80., 0}}, {{81., 
               0.08014980609479941}, {81., 0}}, {{82., 0.06409239020723813}, {
               82., 0}}, {{83., 0.21925791371248549`}, {83., 0}}, {{84., 
               0.35939841966324915`}, {84., 0}}, {{85., 
               0.35828728876267235`}, {85., 0}}, {{86., 
               0.27473032806196185`}, {86., 0}}, {{87., 
               0.23814914016358962`}, {87., 0}}, {{88., 0.2670507044407793}, {
               88., 0}}, {{89., 0.261168925351317}, {89., 0}}, {{90., 
               0.1639768574084798}, {90., 0}}, {{91., 0.06424247766525046}, {
               91., 0}}, {{92., 0.0907182017219796}, {92., 0}}, {{93., 
               0.2351784340232024}, {93., 0}}, {{94., 0.34233399154799293`}, {
               94., 0}}, {{95., 0.29155764744866813`}, {95., 0}}, {{96., 
               0.14272908804198514`}, {96., 0}}, {{97., 
               0.05944883164181207}, {97., 0}}, {{98., 
               0.10853464871996568`}, {98., 0}}, {{99., 
               0.19400229787494983`}, {99., 0}}, {{100., 
               0.20580588336776495`}, {100., 0}}}, VertexColors -> None]}}}, 
         Annotation[#, "Charting`Private`Tag$472294#2"]& ]}, {
        Directive[
         PointSize[0.004766666666666667], 
         RGBColor[0.560181, 0.691569, 0.194885], 
         AbsoluteThickness[1.6]], 
        TagBox[{{{
            Directive[
             Opacity[0.2], 
             PointSize[0.004766666666666667], 
             RGBColor[0.560181, 0.691569, 0.194885], 
             AbsoluteThickness[1.6]], 
            LineBox[{}, VertexColors -> None]}, {
            Directive[
             Opacity[0.2], 
             PointSize[0.004766666666666667], 
             RGBColor[0.560181, 0.691569, 0.194885], 
             AbsoluteThickness[1.6]], 
            
            LineBox[{{{0., 1.}, {0., 0}}, {{1., 0.14688186597535335`}, {
               1., 0}}, {{2., 0.20794509082418144`}, {2., 0}}, {{3., 
               0.12028906775492479`}, {3., 0}}, {{4., 
               0.024841350035180787`}, {4., 0}}, {{5., 
               0.12677064745977798`}, {5., 0}}, {{6., 0.3727427529637378}, {
               6., 0}}, {{7., 0.02374128750078819}, {7., 0}}, {{8., 
               0.8235736223129244}, {8., 0}}, {{9., 0.32082782245365615`}, {
               9., 0}}, {{10., 0.13275210962045736`}, {10., 0}}, {{11., 
               0.07732413584071929}, {11., 0}}, {{12., 
               0.17461715475829329`}, {12., 0}}, {{13., 
               0.18123610801320955`}, {13., 0}}, {{14., 
               0.40834662779883013`}, {14., 0}}, {{15., 
               0.039241333200836795`}, {15., 0}}, {{16., 
               0.44312219896125227`}, {16., 0}}, {{17., 0.3560965353505799}, {
               17., 0}}, {{18., 0.27281743461193697`}, {18., 0}}, {{19., 
               0.06931067080709102}, {19., 0}}, {{20., 
               0.28422496117755836`}, {20., 0}}, {{21., 0.3593984196632498}, {
               21., 0}}, {{22., 0.2670507044407775}, {22., 0}}, {{23., 
               0.09071820172198057}, {23., 0}}, {{24., 
               0.14272908804198498`}, {24., 0}}, {{25., 0.2058058833677655}, {
               25., 0}}, {{26., 0.4982854468345328}, {26., 0}}, {{27., 
               0.2394774472048919}, {27., 0}}, {{28., 0.2169943069889073}, {
               28., 0}}, {{29., 0.5617252498850707}, {29., 0}}, {{30., 
               0.10804990265405995`}, {30., 0}}, {{31., 
               0.059944155532216103`}, {31., 0}}, {{32., 0.053583784372118}, {
               32., 0}}, {{33., 0.04020395239534878}, {33., 0}}, {{34., 
               0.5713227883020997}, {34., 0}}, {{35., 0.5709474069966618}, {
               35., 0}}, {{36., 0.06012956911331546}, {36., 0}}, {{37., 
               0.5981540872330643}, {37., 0}}, {{38., 0.07696174886032237}, {
               38., 0}}, {{39., 0.003151694615851408}, {39., 0}}, {{40., 
               0.08181801487685336}, {40., 0}}, {{41., 0.0423148159862755}, {
               41., 0}}, {{42., 0.41961833151098465`}, {42., 0}}, {{43., 
               0.8287895825413215}, {43., 0}}, {{44., 0.004610265312133072}, {
               44., 0}}, {{45., 0.4320019444893529}, {45., 0}}, {{46., 
               0.1291384160043394}, {46., 0}}, {{47., 0.08694929890756226}, {
               47., 0}}, {{48., 0.1040410909582122}, {48., 0}}, {{49., 
               0.18258450392981215`}, {49., 0}}, {{50., 
               0.19814217248709967`}, {50., 0}}, {{51., 0.7870018507570375}, {
               51., 0}}, {{52., 0.09729003337558874}, {52., 0}}, {{53., 
               0.25801117771019144`}, {53., 0}}, {{54., 
               0.12351464825306102`}, {54., 0}}, {{55., 0.3456286662642313}, {
               55., 0}}, {{56., 0.1443780909704217}, {56., 0}}, {{57., 
               0.2633227145505837}, {57., 0}}, {{58., 0.08116426250667741}, {
               58., 0}}, {{59., 0.4777792189152672}, {59., 0}}, {{60., 
               0.1909866238641553}, {60., 0}}, {{61., 0.28855227345660367`}, {
               61., 0}}, {{62., 0.04471111468951083}, {62., 0}}, {{63., 
               0.5864306554376981}, {63., 0}}, {{64., 0.29903400676901853`}, {
               64., 0}}, {{65., 0.17513572045642653`}, {65., 0}}, {{66., 
               0.06908513453139617}, {66., 0}}, {{67., 
               0.15583990361251043`}, {67., 0}}, {{68., 
               0.15176024153629367`}, {68., 0}}, {{69., 0.5010162658736081}, {
               69., 0}}, {{70., 0.04010297293622708}, {70., 0}}, {{71., 
               0.5878529801228433}, {71., 0}}, {{72., 0.5338958053475457}, {
               72., 0}}, {{73., 0.033047740921380506`}, {73., 0}}, {{74., 
               0.053965767377878726`}, {74., 0}}, {{75., 
               0.02133748633568558}, {75., 0}}, {{76., 
               0.041884949495914994`}, {76., 0}}, {{77., 
               0.6611810740636426}, {77., 0}}, {{78., 0.21216193427031868`}, {
               78., 0}}, {{79., 0.35426712853911163`}, {79., 0}}, {{80., 
               0.6602140905211801}, {80., 0}}, {{81., 
               0.019350645662333146`}, {81., 0}}, {{82., 
               0.02834563928624456}, {82., 0}}, {{83., 0.04028215705175919}, {
               83., 0}}, {{84., 0.03300119763833313}, {84., 0}}, {{85., 
               0.5943689168581612}, {85., 0}}, {{86., 0.4446518599456878}, {
               86., 0}}, {{87., 0.10873893738209442`}, {87., 0}}, {{88., 
               0.5509686805684166}, {88., 0}}, {{89., 0.1435974096853701}, {
               89., 0}}, {{90., 0.12834708996074157`}, {90., 0}}, {{91., 
               0.06251109226758503}, {91., 0}}, {{92., 0.166862544910658}, {
               92., 0}}, {{93., 0.3694208538871401}, {93., 0}}, {{94., 
               0.5094935752046016}, {94., 0}}, {{95., 
               0.035247018489091925`}, {95., 0}}, {{96., 
               0.32111013445879205`}, {96., 0}}, {{97., 
               0.23450923669079868`}, {97., 0}}, {{98., 
               0.43335441118033624`}, {98., 0}}, {{99., 
               0.05177460729885723}, {99., 0}}, {{100., 
               0.28761949944104054`}, {100., 0}}}, VertexColors -> None]}}}, 
         Annotation[#, "Charting`Private`Tag$472294#3"]& ]}}, {
       TagBox[{{
          Directive[
           PointSize[0.004766666666666667], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]], {{}, Null, 
           GeometricTransformationBox[
            InsetBox[
             GraphicsBox[{
               EdgeForm[], 
               DiskBox[{0, 0}]}, {DefaultBaseStyle -> {"Graphics", 
                 Directive[
                  PointSize[0.004766666666666667], 
                  RGBColor[0.368417, 0.506779, 0.709798], 
                  AbsoluteThickness[1.6]]}}], {0, 0}, Automatic, 
             Offset[10]], CompressedData["
1:eJxdlHtQVGUYxjcQRJokkAJvaMgwJAvJbRG88CywwCqX5bZAXOIyy5BoCIQI
mR51EHAMMoYylZDrJqAIqMQqtCq4IgUCglzltoBFoFyLoamc8T3/dGbOnPnN
c57vnO99n/f7IDLOR6LK4XAkr++3Xt8qnP9frxzYp1F5mET91/vEHIxo2ffN
5j0m1sAfQzoVTi0NxO9iWbyoUDn8PbEulMHJzmr2cmJ9HLdNjF3V/4x4E3iL
aV2FXheIt8K465Z27ce/ExtCfEQQG5/xlNgIUQ0lMWr/sOsZw+TiFdnplhpi
E7TOMwN9QQ+Jt2N1dWRZg6WCmIubKwvKIMM+YnO0MydKDusVE+9AkHI7b3PI
ALEFYsyitggfdxNbQmWpn/8sqZ3YCqNBEfqBDVXE1tCT7VHW7+ggtsGCaoV9
JIfdLw/aF491B+uxflsM7z036GlXS7wTcaplYXPObL3t0PrIYqQngK23PYwz
sopfjA0R78LE7MtDltJW4t0wkv9pdvRhC/EehHOsdkmXR4j34rr17iyTq3eI
HVDQaKHHqbpODHzWNJfgH1f+hhlgIOVA8+Vctj58bJyLlrm4jZLOhxV3/Qkr
ATHHERtOyjI9mmk9xhHtXn6aukZjpDtBOiEZfVBD/WKccIkp+zC3/VPSnWFe
anBKfe4m6c5Y4l3IE5aVkC7AuM7VHvV+6h8jQOqyxp34NDYvLjjGHSznjSaQ
7oLpv3q+mCrpJ90VyRXV5y6lU34YV1R12Zp6Od4m3Q02Whv74wplpLthjeD8
0+kwNj9CJJpLVOtCmkkXYl1OyEmDj34jfR+ucXMm/538ifR9iDE8L+KffkL6
fqRMdsxIf/iZ9P24n3W2WmHA5ssdnppf2qykUv8Zd7xK6Tjt2sf6PVA9rx1q
rmDr44HPG/8Wvsx5TronZkzuTjkkPCLdE6aVsQtFyWwevcAdq10briwl3Qv3
+G07NRvZ/onwvGEw/ZNtnW8YIqyOGpjsOUDzxIigWZ9o93Ul5V0uQm/d7YHs
uQfk94Yif7PZyEFieEPP4FsnX41h8nujNz05NTyD8iT3Rl1q9jtVbez3fXBr
7Yy04j3KK3zAz53mFk5dIb8PNpWtlEcXUD7lPhBKlpKP9+aS3xf1htk3ZuMp
L/DFxC/2PInJOPl90dL5jfsWE5oPuS+OKBUaogq2/n54v0bpnrKV3ocffHs2
9Eqf5JDfDyLlUGmReh75/bDmsvvEQD47H/7Iv2canzFO/wt/SAVJS9pqlH/G
Hy/yjdaZJdH5IvdHZ35/kaibnUcx1LhqOpkF7P7FaGu2iIiOYPMgBs4sHrx2
iPIrF8PZYlpfxrlB/gAkKH5MlQc3kT8AY0spod8V0/nDBGC4M/xokwf1Qx6A
+IjIyvG3C8kfiOrM1DTtr+i8RSA8rNdrRa+i84UJRKjVxDbduzRP8kDMC+zO
Wp0qI38QNArn8oJjOhz+Awgh4bc=
            "]], {}}}}, Annotation[#, "Charting`Private`Tag$472294#1"]& ], 
       TagBox[{{
          Directive[
           PointSize[0.004766666666666667], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]], {{}, Null, 
           GeometricTransformationBox[
            InsetBox[
             GraphicsBox[{
               EdgeForm[], 
               PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, {
              DefaultBaseStyle -> {"Graphics", 
                 Directive[
                  PointSize[0.004766666666666667], 
                  RGBColor[0.880722, 0.611041, 0.142051], 
                  AbsoluteThickness[1.6]]}}], {0, 0}, Automatic, 
             Offset[7]], CompressedData["
1:eJxdk3lQlHUYx18uoZziMMBIR0CGIe7lFFL4cuzicsMu7CIrCbJFMSVpkKjp
6xAKgmOpOUaKYByFVIACLZergCAoELKIHOIqGSEgQWDaaDnD8/7Tzryz85nP
+33f33O8Fkk7ouVaDMPIX14aLy9N5v+/OV/unz9WvP6EfJKYwaWsxKbP534l
1sPKeflrfM1dxAawvpAgX3HzKvEbcOZlhox9NU68GtUZh+zPCH8jXgNXmx59
RnqP2Bzj+t7Df57tIrbE7zt75bzgU8RW0Eif+/fj9EJia9jlhVru29JIbIPp
caPKgO4WYltsm9tadVZWTWyPskRLnunQaWJHCJ2eDL167iSxMzQkix2aad8Q
86AMe/zsmIy73wXWU/njuepyYlf0R/Xu6LioIHbDVPxngTreSmJ3lKjrIzwP
XyL2QMj0gtHb988Re0KXdW56c5A77wYc9NyVqj1ym9gL/mqN9yxcHxB742Du
+ypnu/vE72Dt+ut7nzVy89gIzcVs1fkI7rybcOC7zNaOpSZiH2SbtGdo53H9
9oVdsdXfPzc9IgbMVbWG9VumlpkF1jT0J1iWjJD3w5fNelbr+qmfrB/4wzoq
T4sK8v4QZfBTP8kZIO+PKkO/e2E31OQD0BLclLVhit7PBkBHMKvYc+8W+UAk
t5Sm6Lyg/rGBWDmtN/NpFjdfPrIDN40aa7WS5+Pk/pumatkV8gK8XlDUkNV9
kbwAExX6qW3aNeSDsPTwynS6G+0nG4TWOulTK2tu3zajdYEdHY67Rn4zrGcd
jetK68kLYXKtbKgxp4q8EOMOlkb6mpfJB8OwJqmixaWDfDDa84Pvz83Q85gQ
eJmY5/bXt5MPwVRG661GXh/5UCj++WsiznKYfCgeFpgdOR1+l3wYUnzPpE1m
qsiHIWz7A1mKB9efcAyxB0rTTEvIh6Nb8PxxZX0v+QgUls8vhRbRPNgI7DZL
7/ugeYJ8JIQTth5rZaPLjEhkli9aDRRy/YpEV4lt97aG88usjMSKvP0zXi+o
HiYKHzpsXyfsGqR8FMLLr//yg+AO5aMgtO3W7d1D81ZG4fJb7NUkVQ/lo8Es
jfjdTqd9RjQEfzi5KGzpfjYaurUGNcPibspHI2vNkTuvPKJ5MyIsxCWulrbQ
fkKEnISyysKnVD8rwmF260Z30RjlRXgyy2/78SjXXzFWNWyaaHbup7wY/l6L
39Z8Qd8vK0Zx3+h4fArNXylGWnJyVYnBDcrHYFKr0juJoe8XMYhWLPQ4zFI/
2Bg8rD2W5fg11aeMwXGZsPPCXq7+WNgU7BuMN+Xqj4VfUtDd53W0H2ws3OWP
T/Cet1E+Fh7Gp6Z5O+k8jAQ3ffLHwr1oXyGBQvxRtciMns9KEH6AHbgxSfuj
lEDtZp+i/p7qZaTYrVWRMB9I84YUh5rf7ViV9hPlpTju1OQz00n7ppSiKEnm
bajqpHwc+jp56iFJl+9/D1nhlg==
            "]], {}}}}, Annotation[#, "Charting`Private`Tag$472294#2"]& ], 
       TagBox[{{
          Directive[
           PointSize[0.004766666666666667], 
           RGBColor[0.560181, 0.691569, 0.194885], 
           AbsoluteThickness[1.6]], {{}, Null, 
           GeometricTransformationBox[
            InsetBox[
             GraphicsBox[{
               EdgeForm[], 
               PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}, {
              DefaultBaseStyle -> {"Graphics", 
                 Directive[
                  PointSize[0.004766666666666667], 
                  RGBColor[0.560181, 0.691569, 0.194885], 
                  AbsoluteThickness[1.6]]}}], {0, 0}, Automatic, 
             Offset[7]], CompressedData["
1:eJxdlHtQVGUYxjcRYqi4SYGWSMAwCAtxc7mI8nC/uLDLdYFFAgqGBAfBEN0s
jxAJjIHKYEihyFUXEoGSRMWdALlVIHGThQhYIGPwsgFqNJYzvuefzsyZM795
zvOd873v837vJqSFJKpwOJzEF/crL+4NnP9fj9zYp2l9bKLazz8SczCp5TLx
uLyPWB1/T+s2ePa3E2tDW7TaveHAOWI9zIuzvFRdZMQGkDgeTNkoHyN+B3Gr
uSOVglJiIxiNfK/TGv0nsTEiDnmnpOcNE5sisr0mWfU5u54ZtMsq2nL6W4jN
MfAXMzkRdYfYAq83J0jb7bqJubi0vqKIMp4gtobH8WM1B/SriW0QoLDgbY2Z
JLZFutUH2/z7Ront8HRV7j6WeZfYHoqoeIPI9iZiB7zVtktxy2aIeAdWVBpc
EjjsfnlQLzs6KtZn/Y7Y5HZyKsi5ldgJGSrSWKUXW29nKHpsZ8ZFbL1d4JpX
WP3H3DTxTpgpH+63q/uF2BUDt59YHb7TT7wLhzj2O+uezRDvBtfBtdD88g1i
NzzqtNXnNF0hBj7uUmaEp9W/ZAbYLdnX+00JWx936CqT2nz8Zkl3RzR38zF7
b2KOBximLT+wl9ZjPDAgCNPQM50j3ROlC4mzHS3UL8YTnKPS7SV3PyLdC8m1
htlqyu9I94K1c2m5v7SGdG806l4eV5NT/xhvnHumfiM9l82LDyq2T9XzZjNI
98GVp+OfLNXISfeFU0Pzya9PUH4YX6yMOFoKPK6R7gc1zbflaZVtpPvB1/v0
8HIsmx9/lFgnqlyP6SXdHxrFMccN37tPegB6ucWL/y7+QHoAvIxPC91zBknf
A6fFoQd152+TvgcLhQXN3YZsvvjgaXy6Y11C/Wf40JEM5fhOsP5AlK7o7LXu
ZusTiFOd//g/LP6N9CA8Mb+55JbRQ3oQ9BtTVqqy2DwKoDXXqhmnqCVdgDL3
ASeNTrZ/QtxvnzrxvsmvLxlCCBImF8f30TwxQvjcOuh8qpHyLhPC6Pq1ySJl
B/mDMX9hq9VMKjGCwTM86xmq/jv5g8HNz5LE5VGeZMGYkRS90TTAfj8E9ZoP
6hrepLwiBO1nlrmVSxXkD4GNdL0+6SLlUxYC8w/Xsj67V0L+UESbFF19nE55
QSj6fnLhJZrPkz8UY8Nn+NvMaT5koRArutWFDWz9w6DSouAfMaL3EYbPR7bc
qxssJn8Y4mama6vUyskfhsFy/sLkBXY+wmHWYZmeN0//i3CUemeu6ahS/plw
nK0w3WSVSeeLLBzZ5+VVwlF2HiPw3FJVN/8iu/8IaPTZxifFs3mIwJYvVlO/
3U/5lUXAwmbZoI1zlfwiGPVcksjEXeQXIXrtyN6vqun8YURQGY473BVI/ZCJ
kJqQ0Dj/WiX5I/FqgSRX50s6bxEJE4fNWkkb6XxhIsG3XzDRu0nzJItEkodz
gX22lPxREFcqy8XJQ27/AVeJ2d0=
            "]], {}}}}, 
        Annotation[#, "Charting`Private`Tag$472294#3"]& ]}}, {}, {}}, {
    DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> True, 
     AxesOrigin -> {0, 0}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
       "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "DefaultPlotStyle" -> {
         Directive[
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.560181, 0.691569, 0.194885], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.922526, 0.385626, 0.209179], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.528488, 0.470624, 0.701351], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.772079, 0.431554, 0.102387], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.363898, 0.618501, 0.782349], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[1, 0.75, 0], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.647624, 0.37816, 0.614037], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.571589, 0.586483, 0.], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.915, 0.3325, 0.2125], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[
          0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
          AbsoluteThickness[1.6]], 
         Directive[
          RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
          AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
       "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> 
       Scaled[0.05]}, PlotRange -> {{0, 100}, {0, 1.}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Basic version\"", "\"(Incorrect?) simplified formula\"", 
       "\"From recursion\""}, "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    DiskBox[{0, 0}]}, {DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, ImageSize -> {10, 10},
                     PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, ImageSize -> {10, 7}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[-0.032857142857142835`] -> 
                    Baseline)], #2}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]], {
                    InsetBox[
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}, {
                    DefaultBaseStyle -> {"Graphics", {
                    AbsolutePointSize[6]}, 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    RGBColor[0.560181, 0.691569, 0.194885], 
                    AbsoluteThickness[1.6]]}}], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]], Automatic, 
                    Scaled[1]]}}}, AspectRatio -> Full, ImageSize -> {10, 7}, 
                    PlotRangePadding -> None, ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[-0.032857142857142835`] -> 
                    Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.004766666666666667`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.368417, 0.506779, 0.709798]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.004766666666666667`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.880722, 0.611041, 0.142051]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.004766666666666667`", "]"}], 
                   ",", 
                   
                   TemplateBox[<|
                    "color" -> RGBColor[0.560181, 0.691569, 0.194885]|>, 
                    "RGBColorSwatchTemplate"], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    DiskBox[{0, 0}]}], ",", 
                    RowBox[{"Offset", "[", "10", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{-1, -1}, {1, -1}, {1, 1}, {-1, 1}}]}], ",", 
                    RowBox[{"Offset", "[", "7", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{
                    GraphicsBox[{
                    EdgeForm[], 
                    PolygonBox[{{0, 1}, {1, 0}, {0, -1}, {-1, 0}}]}], ",", 
                    RowBox[{"Offset", "[", "7", "]"}]}], "}"}]}], "}"}]}], 
           ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"False", ",", "False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.958847655010806*^9, 3.958847674916089*^9}, {
   3.958847766945867*^9, 3.958847778563033*^9}, {3.9588478279463778`*^9, 
   3.9588478836968517`*^9}, {3.958848037551371*^9, 3.958848191922386*^9}, {
   3.958848235306798*^9, 3.9588482790218067`*^9}, 3.958848310399536*^9, {
   3.9588483536930027`*^9, 3.9588483716083*^9}, 3.958848415950684*^9, {
   3.958848465391721*^9, 3.958848570310423*^9}, 3.958848608835002*^9, {
   3.9588488380167*^9, 3.958848849417718*^9}, {3.959100069463789*^9, 
   3.959100095732944*^9}, {3.9591003999967203`*^9, 3.959100419324292*^9}, {
   3.959100843141*^9, 3.959100908655265*^9}, {3.959101167313108*^9, 
   3.959101208686833*^9}, {3.959101243985557*^9, 3.959101252996315*^9}, {
   3.959101708046175*^9, 3.9591017368462877`*^9}, {3.9591017698739443`*^9, 
   3.959101781843354*^9}, 3.959170823634251*^9},
 FontSize->14,
 CellLabel->
  "Out[334]=",ExpressionUUID->"f4906b97-284d-4c65-9f07-3d2625eeff25"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["r", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Epsilon]"}]], " ", 
            SubsuperscriptBox["d", "1", "4"], " ", 
            SubsuperscriptBox["r", "2", "4"], " ", 
            RowBox[{"UnitStep", "[", 
             RowBox[{"1", "-", "n"}], "]"}]}], "-", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"8", " ", "\[ImaginaryI]", " ", 
              RowBox[{"(", 
               RowBox[{"\[Eta]", "+", 
                RowBox[{"n", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]}], ")"}]}]], 
            " ", 
            SubsuperscriptBox["d", "1", 
             RowBox[{"4", " ", "n"}]], " ", 
            RowBox[{"UnitStep", "[", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "n"}], "]"}]}], "+", 
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"8", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["\[ExponentialE]", 
                RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
               SubsuperscriptBox["d", "1", "4"], " ", 
               SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"], " ", 
            RowBox[{"UnitStep", "[", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "n"}], "]"}]}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
         SubscriptBox["r", "2"]}]]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "4"}], " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Epsilon]"}], "+", "\[Eta]"}], ")"}]}]], " ", 
        
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["r", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["d", "1", "4"], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{"1", "-", "n"}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"8", " ", "\[ImaginaryI]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{
                  RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Epsilon]", "+", "\[Eta]"}], ")"}]}]], " ", 
                SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{
                  RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Epsilon]", "-", "\[Eta]"}], ")"}]}]], " ", 
                SubsuperscriptBox["d", "1", "4"], " ", 
                SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}], ")"}], " ", 
           RowBox[{"UnitStep", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "n"}], "]"}]}]}], ")"}]}], 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], " ", 
         SubscriptBox["r", "2"]}]}]]}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{"2", "*", 
      RowBox[{"Re", "[", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["r", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"8", " ", "\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Eta]", "+", "\[Epsilon]"}], ")"}]}]], " ", 
              SubsuperscriptBox["d", "1", "4"]}], ")"}], "n"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{
                RowBox[{"-", "8"}], " ", "\[ImaginaryI]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Eta]", "-", "\[Epsilon]"}], ")"}]}]], " ", 
              SubsuperscriptBox["d", "1", "4"], " ", 
              SubsuperscriptBox["r", "2", "4"]}], ")"}], "n"]}], ")"}]}], 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "\[Eta]"}]], "+", 
         SubscriptBox["r", "2"]}]], "]"}]}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["r", "2"], "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{
      SubscriptBox["d", "1"], "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"n", "->", 
      RowBox[{"RandomInteger", "[", "100", "]"}]}], ",", 
     RowBox[{"\[Epsilon]", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "\[Pi]"}], "}"}], ",", "1"}], "]"}]}], ",", 
     RowBox[{"\[Eta]", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "\[Pi]"}], "}"}], ",", "1"}], "]"}]}]}], "}"}]}], "//",
   "N"}]], "Input",
 CellChangeTimes->{{3.959451539137053*^9, 3.9594515410884132`*^9}, {
  3.9594515995596247`*^9, 3.959451688893338*^9}, {3.9594522060405893`*^9, 
  3.959452211551135*^9}, {3.9596871778694696`*^9, 3.9596872484343653`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"e93a8a97-61b1-41fb-83f6-18530ef6b465"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.3177617275868155`*^-85", "+", 
   RowBox[{"4.584543478119963`*^-85", " ", "\[ImaginaryI]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.95945159770814*^9, 3.959451620083406*^9}, {
  3.959687231514185*^9, 3.959687253969429*^9}},
 CellLabel->"Out[26]=",ExpressionUUID->"b113b54a-686a-4141-a688-a86a4fba3401"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1586, 866},
WindowMargins->{{9, Automatic}, {4, Automatic}},
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"17e01c87-4c47-4212-9ca4-3e03b14eb032"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 198, 3, 67, "Section",ExpressionUUID->"55b79880-2956-440d-9d56-5451b79343e1"],
Cell[781, 27, 1673, 38, 110, "Text",ExpressionUUID->"a4dc8ee4-e9ce-4559-a0ca-accc5e421d9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2491, 70, 191, 3, 67, "Section",ExpressionUUID->"d1ce3c16-d565-40e4-a6bd-b7739b782d8c"],
Cell[CellGroupData[{
Cell[2707, 77, 160, 3, 54, "Subsection",ExpressionUUID->"68dd9af3-7337-4023-b15f-872a370711ab"],
Cell[2870, 82, 384, 8, 35, "Text",ExpressionUUID->"89fc5a1f-584d-4905-8cf8-c1ebbd1f0bea"],
Cell[CellGroupData[{
Cell[3279, 94, 2651, 70, 174, "Input",ExpressionUUID->"dd1b35d0-0676-4d43-b0a9-b89cb932ebaf"],
Cell[5933, 166, 1651, 45, 109, "Output",ExpressionUUID->"c12f396e-58e0-45b6-bc92-59fb0303da22"],
Cell[7587, 213, 1914, 52, 157, "Output",ExpressionUUID->"2093ed95-6187-4418-9118-7591e146e942"]
}, Open  ]],
Cell[9516, 268, 168, 3, 35, "Text",ExpressionUUID->"1ff696ee-143d-4faf-836f-9a5bffe84731"],
Cell[9687, 273, 2680, 75, 91, "Input",ExpressionUUID->"f56cc8ce-4fd0-44c9-bedd-6641034c50c0"],
Cell[12370, 350, 369, 5, 35, "Text",ExpressionUUID->"cee6c32b-8282-460e-a709-6b084f8d2d16"]
}, Closed]],
Cell[CellGroupData[{
Cell[12776, 360, 160, 3, 38, "Subsection",ExpressionUUID->"814929b1-5e1b-445b-969a-594e8fda502e"],
Cell[CellGroupData[{
Cell[12961, 367, 1527, 40, 119, "Input",ExpressionUUID->"ac5953f5-b527-4555-b7f0-7641c0647b5d"],
Cell[14491, 409, 1726, 46, 113, "Output",ExpressionUUID->"41fab7d2-8fe0-49f9-867d-6bb2eac0a4a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16254, 460, 1125, 29, 54, "Input",ExpressionUUID->"bb02253f-c2a6-49ee-bb5a-5cb560a9dbca"],
Cell[17382, 491, 4983, 145, 165, "Output",ExpressionUUID->"59d76d93-b3ea-4dd2-9a09-7a32bedbb8eb"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22426, 643, 289, 4, 67, "Section",ExpressionUUID->"d26d523d-fb9f-4dd3-b2f4-6a0437a9200e"],
Cell[CellGroupData[{
Cell[22740, 651, 450, 12, 54, "Subsection",ExpressionUUID->"aa338469-8ac3-4ba3-9901-032f341c6954"],
Cell[23193, 665, 987, 25, 58, "Text",ExpressionUUID->"04e7b6ea-7189-413b-81c3-989f8e0c16df"],
Cell[CellGroupData[{
Cell[24205, 694, 313, 9, 45, "Subsubsection",ExpressionUUID->"658b1950-7ca9-4a47-ae19-03b4f6c8cc19"],
Cell[24521, 705, 233, 6, 30, "Input",ExpressionUUID->"bb85a3e5-f55b-4b0c-bd59-36d22f81a9da"],
Cell[CellGroupData[{
Cell[24779, 715, 3321, 98, 242, "Input",ExpressionUUID->"640e58fa-8b57-4d66-a78a-f5c70bb2ace2"],
Cell[28103, 815, 9786, 315, 176, "Output",ExpressionUUID->"084e423e-4f2c-4591-a999-da0961c513c6"]
}, Open  ]],
Cell[37904, 1133, 3286, 90, 144, "Input",ExpressionUUID->"cc56200a-8169-4f81-9973-fd212534c3bb"],
Cell[CellGroupData[{
Cell[41215, 1227, 448, 11, 30, "Input",ExpressionUUID->"bff4feaa-98e5-4810-b51b-3b9630297302"],
Cell[41666, 1240, 13991, 428, 215, "Output",ExpressionUUID->"5906f908-6837-4b41-86dc-575ab7f727ab"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55706, 1674, 385, 10, 36, "Subsubsection",ExpressionUUID->"08e39ea8-6d2c-44f0-b3b2-8b528a41afab"],
Cell[CellGroupData[{
Cell[56116, 1688, 4478, 135, 257, "Input",ExpressionUUID->"a014baa0-e0b3-4d78-93d9-f2060f36ccff"],
Cell[60597, 1825, 13868, 426, 215, "Output",ExpressionUUID->"ef64121e-d4bf-4561-8578-627ee7c94fd3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[74514, 2257, 426, 12, 37, "Subsubsection",ExpressionUUID->"f19a52d0-a7eb-4100-8241-e60e8b237456"],
Cell[CellGroupData[{
Cell[74965, 2273, 481, 14, 30, "Input",ExpressionUUID->"5eaa99a9-49a5-4863-a029-a761abb436d3"],
Cell[75449, 2289, 568, 14, 34, "Output",ExpressionUUID->"6f8738af-edf6-4954-862b-fd9ca35b5171"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[76078, 2310, 201, 3, 38, "Subsection",ExpressionUUID->"8c4cfcf9-5e81-410d-9057-a2582f027bad"],
Cell[76282, 2315, 1431, 50, 44, "Text",ExpressionUUID->"ec2375c9-1eb8-4c9e-8704-ab213c87068b"],
Cell[77716, 2367, 11194, 309, 427, "Input",ExpressionUUID->"06813e67-a5f7-4b06-8e81-5803d009511c"]
}, Closed]],
Cell[CellGroupData[{
Cell[88947, 2681, 202, 4, 38, "Subsection",ExpressionUUID->"796a2975-e186-46a7-a227-a14a5db9d107"],
Cell[89152, 2687, 839, 23, 37, "Text",ExpressionUUID->"d7661c1d-28a7-4f41-8b18-1a94b11a671d"],
Cell[89994, 2712, 8199, 226, 296, "Input",ExpressionUUID->"ddbeacaf-e7e1-4136-b5c9-7f6d4f7677e4"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[98242, 2944, 166, 3, 67, "Section",ExpressionUUID->"ee2d41f5-2edd-4beb-90f7-db849e272c4c"],
Cell[98411, 2949, 341, 7, 35, "Text",ExpressionUUID->"07012183-0e06-4dc7-8809-6d9e8f669ff1"],
Cell[98755, 2958, 3693, 99, 144, "Input",ExpressionUUID->"e15a4676-6279-409d-ab83-76b66e37d0ac"],
Cell[CellGroupData[{
Cell[102473, 3061, 335, 6, 30, "Input",ExpressionUUID->"068d1f1e-1779-4e5d-9b14-fbeefc4beee7"],
Cell[102811, 3069, 17858, 501, 290, "Output",ExpressionUUID->"6903ab7c-cce9-4743-ad1b-01a5b7cb3052"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120706, 3575, 187, 3, 54, "Subsection",ExpressionUUID->"4adbe8c0-782a-4ae3-863d-6556079221db"],
Cell[120896, 3580, 698, 18, 33, "Input",ExpressionUUID->"a9ddc569-1d4f-4391-9f30-25bdb07422b1"],
Cell[121597, 3600, 192, 3, 35, "Text",ExpressionUUID->"3df44220-16c1-4762-87ed-d8b565d31c4c"],
Cell[CellGroupData[{
Cell[121814, 3607, 323, 8, 30, "Input",ExpressionUUID->"0b03e3c7-0ef7-45cb-ad38-d97db32e9428"],
Cell[122140, 3617, 1651, 54, 109, "Output",ExpressionUUID->"e7571773-95dd-4f19-b0bd-5248f34f8a67"]
}, Open  ]],
Cell[123806, 3674, 1947, 51, 94, "Input",ExpressionUUID->"f1b1ceb2-8644-4440-a140-853944ac2d6c"],
Cell[CellGroupData[{
Cell[125778, 3729, 5114, 142, 203, "Input",ExpressionUUID->"1503b701-fd4a-4eae-9e34-631f6673e5f9"],
Cell[130895, 3873, 19096, 488, 393, "Output",ExpressionUUID->"0810b75b-69b2-4865-bf60-7a73b57cb8fc"]
}, Open  ]],
Cell[150006, 4364, 5447, 142, 304, "Text",ExpressionUUID->"308468b7-9724-4419-920f-67b8a178ccee"],
Cell[155456, 4508, 287, 9, 40, "Text",ExpressionUUID->"df2287d3-f33b-4e3a-bf92-34b4773b20ba"],
Cell[CellGroupData[{
Cell[155768, 4521, 795, 25, 54, "Input",ExpressionUUID->"981595c1-db0c-4a3d-b1ac-06f62f5ea18c"],
Cell[156566, 4548, 15055, 435, 295, "Output",ExpressionUUID->"ce2717e6-761b-466b-8df8-22f7f483f4c8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171658, 4988, 8154, 206, 219, "Input",ExpressionUUID->"ee5ab003-8b1d-4e61-8483-b79581776a74"],
Cell[179815, 5196, 37306, 701, 240, "Output",ExpressionUUID->"f4906b97-284d-4c65-9f07-3d2625eeff25"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217158, 5902, 6704, 174, 137, "Input",ExpressionUUID->"e93a8a97-61b1-41fb-83f6-18530ef6b465"],
Cell[223865, 6078, 350, 7, 37, "Output",ExpressionUUID->"b113b54a-686a-4141-a688-a86a4fba3401"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

